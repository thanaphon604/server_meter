<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">
    <title>ระบบบันทึกหน่วยไฟฟ้าอัจฉริยะ</title>
    <link rel="stylesheet" href="">
    <style>
        #Head {
    font-size: 20px;
    background-color: #FFA500;
    color: black;
    border: 2px
  }
  div.bigroom{
    width: 100px;
    height: 150px;
    margin-left: 5%
  }
  
  .TextHead{
    font-size: 50px
    
  }body{
         background-color:rgb(236, 236, 236)
  }
  .room{
     
     border: 2px solid black;
    width: 100px;
    height: 90px;
  }
  }.roomgreen{
     background-color: green
     border: 2px solid black;
    width: 100px;
    height: 90px;
  }
  .roomorange{
     background-color: orange
     border: 2px solid black;
    width: 100px;
    height: 90px;
  }
  .roomgrey{
     background-color: grey
     border: 2px solid black;
    width: 100px;
    height: 90px;
  }.divform{
    width: 100%;
    padding: 12px 20px;
    margin: 8px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
    background-color:whitesmoke;

  }#singlebutton{
    width:100%;
    margin-left: 0%  
  
  }
   #img_container{
        
        height: 25px;
        width: 50px;
        display: table-cell;
        vertical-align: middle;
      }
      #img_container img{
       
        margin: auto auto;
        display: block;
      }
      html, body, #container {
  width: 100%;
  height: 75%;
  margin: 0;
  padding: 0;
}
    </style>
</head>

<body>
    <div class="container-fluid" id="Head">
        <div class="class col-sm-12 ">
            <div class="row justify-content-center">
                <ul>
                    <img src="https://www.bpicc.com/images/2018/10/09/Logo_Intregrate.png" width="90px" height="90px"
                        alt="">
                </ul>
                <ul>
                    <img src="https://www.bpicc.com/images/2018/10/09/lg_wu.png" width="80px" height="90px" alt="">
                </ul>
                <div>
                    <ul>
                        <h1>ระบบบันทึกหน่วยไฟฟ้าอัจฉริยะ </h1>
                    </ul>
                    <ul>
                        <h5>(Smart energy monitoring system)</h2>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!--
  Extra small <576px   col
  small > 576      px  col-sm
  mediu, >= 768        col-md
  Large >=992 px       com-lg
  Extra Large >= 120px col-xl
-->
    <nav class="navbar navbar-expand-lg navbar-light bg-light navbar navbar-dark bg-dark">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo02"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
            <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab"
                        aria-controls="pills-home" aria-selected="true">ผังห้อง</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab"
                        aria-controls="pills-profile" aria-selected="false">ผู้เช่า</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-contact-tab1" data-toggle="pill" href="#pills-contact1" role="tab"
                        aria-controls="pills-contact" aria-selected="false">จดมิเตอร์</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-contact-tab2" data-toggle="pill" href="#pills-contact2" role="tab"
                        aria-controls="pills-contact" aria-selected="false">วิเคราะห์การใช้พลังงาน</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-contact-tab3" data-toggle="pill" href="#pills-contact3" role="tab"
                        aria-controls="pills-contact" aria-selected="false">ออกใบเเจ้งหนี้&ใบเสร็จ</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-contact-tab4" data-toggle="pill" href="#pills-contact4" role="tab"
                        aria-controls="pills-contact" aria-selected="false">จัดการหอพัก</a>
                </li>
            </ul>


        </div>
        <form class="form-inline my-2 my-lg-0 fixed-right">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Log out</button>
        </form>
    </nav>
    <div class="tab-content" id="pills-tabContent">
        <!-- ผังห้อง -->
        <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12 order-2 order-sm-2 order-md-2 order-lg-2 col-lg-6  col-xl-7 order-xl-1 ">
                        <div>
                            <div class="" id="divPostHome" style="margin-top:5%">
                            </div>
                        </div>
                        <div id="divPosthr"></div>
                        <form id="myForm" class="container my-3" method="" enctype="" action="">

                            <a class="bg-success d-block text-center rounded mt-4" id="newNodeButton" data-toggle="tooltip"
                                data-placement="top" title="Add new node"><i class="fas fa-plus p-2" style="color:white; font-size: 14px;"></i>เพิ่มชั้น</a>

                        </form>
                    </div>


                    <div class="col-12 order-1 col-lg-6 order-md-1 order-sm-1 order-lg-1 col-xl-5 " style="margin-top: 15%">
                        <div class="row">
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th scope="col" style="background-color: green ; height: 50px;">ห้องว่าง</th>
                                        <th scope="col" style="background-color: orange">มีผู้เช่า</th>
                                        <th scope="col" style="background-color: grey">กำลังปรับปรุง</th>
                                    </tr>
                                </thead>
                                <tbody>

                                    <tr>
                                        <th id="free" scope="row">10</th>
                                        <td id="busy" scope="row"> 30</td>
                                        <td id="remodel" scope="row">1</td>
                                    </tr>

                                </tbody>
                            </table>

                        </div>

                    </div>

                </div>

            </div>

        </div>


        <!-- ผู้เช่า -->
        <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
            <nav>
                <div class="nav nav-tabs" id="nav-tab" role="tablist">
                    <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab"
                        aria-controls="nav-home" aria-selected="true">ผู้เช่าใหม่</a>
                    <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab"
                        aria-controls="nav-profile" aria-selected="false">ผู้เช่าเก่า</a>

                </div>
            </nav>
            <div class="tab-content" id="nav-tabContent">
                <!--ผู้เช่าปัจจุบัน -->
                <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                    <div class="container-fluid" style="margin-top: 30px">
                        <div class="row justify-content-center">
                            <div class="col-lg-7 col-sm-12  ">
                                <br>
                                <table border="2" width="100%" class="table-responsive table table-striped">
                                    <thead class="thead-dark">
                                        <tr>
                                            <th scope="col">ลำดับที่</th>
                                            <th scope="col">ชื่อหอพัก</th>
                                            <th scope="col">เลขห้องพัก</th>
                                            <th scope="col">บัตรประชาชน</th>
                                            <th scope="col">ชื่อ</th>
                                            <th scope="col">นามสกุล</th>
                                            <th scope="col">วันเดือนปีเกิด</th>
                                            <th scope="col">ที่อยู่</th>
                                            <th scope="col">เบอร์โทรศัพท์</th>
                                            <th scope="col">ป้ายทะเบียนยานพาหนะ</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tablePost">

                                    </tbody>
                                </table>

                            </div>

                        </div>
                    </div>
                </div>
                <!--ผู้เช่าใหม่ -->
                <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
                    <div class="container-fluid" style="margin-top: 30px">
                        <div class="row justify-content-center">
                            <div class="col-lg-7 col-sm-12  ">
                                <br>
                                <table border="2" width="100%" class="table-responsive table table-striped">
                                    <thead class="thead-dark">
                                        <tr>
                                            <th scope="col">ลำดับที่</th>
                                            <th scope="col">ชื่อหอพัก</th>
                                            <th scope="col">เลขห้องพัก</th>
                                            <th scope="col">บัตรประชาชน</th>
                                            <th scope="col">ชื่อ</th>
                                            <th scope="col">นามสกุล</th>
                                            <th scope="col">วันเดือนปีเกิด</th>
                                            <th scope="col">ที่อยู่</th>
                                            <th scope="col">เบอร์โทรศัพท์</th>
                                            <th scope="col">ป้ายทะเบียนยานพาหนะ</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tablePostUserdelete">

                                    </tbody>
                                </table>
                            </div>

                        </div>
                    </div>
                </div>

            </div>
        </div>
        <!--จดมิเตอร์ -->
        <div class="tab-pane fade" id="pills-contact1" role="tabpanel" aria-labelledby="pills-contact-tab1">
            <nav>

                <div class="nav nav-tabs" id="nav-tab" role="tablist">
                    <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-saveunit1" role="tab"
                        aria-controls="nav-home" aria-selected="true">บันทึกค่าไฟฟ้าเเต่ละห้อง</a>
                    <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-saveunit2" role="tab"
                        aria-controls="nav-profile" aria-selected="false">บันทึกค่าไฟฟ้าประจำเดือนของหอพัก</a>
                    <a class="nav-item nav-link" id="nav-profile-tab2" data-toggle="tab" href="#nav-saveunit3" role="tab"
                        aria-controls="nav-profile2" aria-selected="false">บันทึกค่่าน้ำประจำเดือนของหอพัก</a>
                    <a class="nav-item nav-link" id="nav-profile-tab3" data-toggle="tab" href="#nav-saveunit4" role="tab"
                        aria-controls="nav-profile2" aria-selected="false">บันทึกค่าน้ำประจำเดือนของหอพัก</a>

                </div>
            </nav>
            <div class="tab-content" id="nav-tabContent">
                <div class="row justify-content-center">
                    <div class="col-md-12 col-lg-8">
                        <br> <br>
                        <div class="">
                            <label for="start">จดมิเตอร์ประจำเดือน:</label>
                            <input type="month" type="" name="start" id="start" name="start" min="2018-03" value="">

                            <div class="row justify-content-center col-lg-3 col-12">
                                <div class="col">
                                    <h3 id="ShowMonth"></h3>
                                </div>
                                <div class="col">
                                    <h3 id="ShowYear"></h3>
                                </div>
                            </div>



                        </div>
                    </div>
                </div>
                {{!-- จดประจำเดือนของห้อง --}}
                <div class="tab-pane fade show active" id="nav-saveunit1" role="tabpanel" aria-labelledby="nav-home-tab">
                    <div class="row justify-content-center">
                        <div class="col-md-12 col-lg-8">
                            <div class="">
                                <div class="" id="divPostmeter" style="margin-top:5%">

                                </div>
                                <div class="row ">
                                    <div class="col-md-12 col-lg-8">
                                        <form action="" name="formUpdateUnitMeter" id="formUpdateUnitMeter" onsubmit="return false">
                                            <button name="formUpdateUnitMeter" type="submit" class="btn btn-primary">บันทึก</button>
                                        </form>
                                    </div>
                                </div>
                                <div id="tablePostUnitMeter">
                                    <div id="tablePostUnitMeterbody">

                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                {{!-- จดมิเตอร์ประจำเดือนของหอพัก(ภาพรวม)--}}
                <div class="tab-pane fade" id="nav-saveunit2" role="tabpanel" aria-labelledby="nav-profile-tab">
                    <div>
                        <div id="setmetermonth">

                        </div>
                        <div>
                            <form action="" name="formUpdateUnitMeterSome" id="formUpdateUnitMeterSome" onsubmit="return false">
                                <button style="margin-left: 20%" name="formUpdateUnitMeterSome" type="submit" class="btn btn-primary">บันทึก</button>
                            </form>
                        </div>
                    </div>

                </div>
                {{!-- จดน้ำประจำเดือนของห้อง --}}
                <div class="tab-pane fade " id="nav-saveunit3" role="tabpanel" aria-labelledby="nav-home-tab">
                    <div class="row justify-content-center">
                        <div class="col-md-12 col-lg-8">
                            <div class="">
                                <div class="" id="divPostwater" style="margin-top:5%">

                                </div>
                                <div id="tablePostwater">
                                    <div id="tablePostUnitMeterbody">

                                    </div>
                                    <div class="col-md-12 col-lg-8">
                                        <form action="" name="formUpdateUnitWaters" id="formUpdateUnitWaters" onsubmit="return false">
                                            <button name="formUpdateUnitWaters" type="submit" class="btn btn-primary">บันทึก</button>
                                        </form>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                {{!-- จดมิเตอร์น้ำประจำเดือนของหอพัก(ภาพรวม)--}}
                <div class="tab-pane fade" id="nav-saveunit4" role="tabpanel" aria-labelledby="nav-profile-tab">
                    <div>
                        <div id="setwatermonth">

                        </div>
                        <div>
                            <form action="" name="formUpdateUnitSomeWater" id="formUpdateUnitSomeWater" onsubmit="return false">
                                <button style="margin-left:20%;margin-top:1%;" name="formUpdateUnitSomeWater" type="submit"
                                    class="btn btn-primary">บันทึก</button>
                            </form>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <!-- วิเคราะห์การใช้พลังงาน  -->
        <div class="tab-pane fade" id="pills-contact2" role="tabpanel" aria-labelledby="pills-contact-tab2">
            <nav>
                <div class="nav nav-tabs" id="nav-tab" role="tablist">
                    <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#analyzehome" role="tab"
                        aria-controls="nav-home" aria-selected="true">วิเคราะห์การใช้พลังงานไฟฟ้าของหอพัก</a>
                    <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#analyzewater" role="tab"
                        aria-controls="nav-profile" aria-selected="false">วิเคราะห์การใช้พลังงานน้ำของหอพัก</a>
                    <a class="nav-item nav-link" id="nav-overload-tab" data-toggle="tab" href="#analyzeoverload" role="tab"
                        aria-controls="nav-overload" aria-selected="false">การใช้พลังงานของห้องที่ไม่มีผู้อาศัย</a>
                </div>
            </nav>
            <div class="tab-content" id="nav-tabContent">
                <br><br>
                <div class="row justify-content-center">
                    <label for="start">เลือกเดือนที่ต้องการ:</label>
                    <input type="month" type="" id="analysis" name="analysis" min="2018-03" value="">

                    <div class="row justify-content-center col-lg-3 col-12">
                        <div class="col">
                            <h3 id="ShowMonthAnalysis"></h3>
                        </div>
                        <div class="col">
                            <h3 id="ShowYearAnalysis"></h3>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade show active" id="analyzehome" role="tabpanel" aria-labelledby="nav-home-tab">

                    <div class="row justify-content-center">
                        <div class="col-md-11 col-lg-8">
                            <br> <br>
                            <h2 style="text-align:center">วิเคราะห์การใช้พลังงานไฟฟ้าของหอพัก</h3>
                                <br>
                                <div class="">

                                    <div class="row ">
                                        <div class="col-md-12 col-lg-6 divform ">
                                            <div id="piechart">

                                            </div>
                                            <div id="setchart">

                                            </div>
                                        </div>
                                        <div class="col-md-11 col-lg-6 divform">
                                            <div id="container">

                                            </div>
                                            <br>
                                            <div id="setchart2" style="text:center">

                                            </div>
                                        </div>

                                    </div>



                                </div>
                        </div>

                    </div>
                </div>
                <div class="tab-pane fade" id="analyzewater" role="tabpanel" aria-labelledby="nav-profile-tab">
                    <div class="row justify-content-center">
                        <div class="col-md-11 col-lg-8">
                            <br> <br>
                            <h2 style="text-align:center">วิเคราะห์การใช้พลังงานการใช้น้ำของหอพัก</h3>
                                <br>
                                <div class="">

                                    <div class="row ">
                                        <div class="col-md-12 col-lg-6 divform ">
                                            <div id="piechartwater">

                                            </div>
                                            <div id="setchartwater">

                                            </div>
                                        </div>
                                        <div class="col-md-11 col-lg-6 divform">
                                            <div id="containerwater" style="height:75%">

                                            </div>
                                            <br>
                                            <div id="setchartwater2" style="text:center">
                                            </div>
                                        </div>

                                    </div>



                                </div>
                        </div>

                    </div>
                </div>
                <div class="tab-pane fade" id="analyzeoverload" role="tabpanel" aria-labelledby="nav-overload-tab">
                    <div class="row justify-content-center">
                        <div class="col-md-11 col-lg-8">
                            <br> <br>
                            <h2 style="text-align:center">วิเคราะห์การใช้พลังงานของหอพักในห้องพักที่ไม่มีผู้อาศัย</h3>
                                <br>
                                <div class="">

                                    <div class="row ">
                                        <div class="col-md-12 col-lg-6 divform ">
                                            <h4>การใช้พลังงานไฟฟ้าของห้องพักที่ไม่มีผู้อาศัย</h4>
                                            <div id="overmeter">

                                            </div>
                                            <div id="stringovermeter">

                                            </div>
                                        </div>
                                        <div class="col-md-11 col-lg-6 divform">
                                            <h4>การใช้พลังงานน้ำของห้องพักที่ไม่มีผู้อาศัย</h4>
                                            <div id="overwater" style="height:75%">

                                            </div>
                                            <br>
                                            <div id="stringoverwater" style="text:center">
                                            </div>
                                        </div>

                                    </div>



                                </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
        <!-- ออกใบเเจ้งหนี้ใบเสร็จ -->
        <div class="tab-pane fade" id="pills-contact3" role="tabpanel" aria-labelledby="pills-contact-tab3">
            <nav>
                <div class="nav nav-tabs" id="nav-tab" role="tablist">
                    <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-invoice" role="tab"
                        aria-controls="nav-home" aria-selected="true">ใบเเจ้งหนี้</a>
                    <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-bills" role="tab"
                        aria-controls="nav-profile" aria-selected="false">ใบเสร็จ</a>

                </div>
            </nav>
            <div class="tab-content" id="nav-tabContent">
                <!--ใบเเจ้งหนี้ -->
                <div class="tab-pane fade show active" id="nav-invoice" role="tabpanel" aria-labelledby="nav-home-tab">
                    <div class="row justify-content-center">
                        <div class="col-md-12 col-lg-8">
                            <br>
                            <h5>*หน้าจอจะเเสดงห้องที่ค้างชำระเท่านั้น</h5>

                            <div class="" id="divPostmeterbuilds" style="margin-top:5%">

                            </div>


                            <form action="" name="formmeter" id="formmeter" onsubmit="return false">
                                <button name="formmeter" type="submit" class="btn btn-primary">ยืนยัน</button>
                            </form>
                            <div id="ggg">

                            </div>
                        </div>

                    </div>
                </div>
                <!--ใบเสร็จรับเงิน -->
                <div class="tab-pane fade" id="nav-bills" role="tabpanel" aria-labelledby="nav-profile-tab">
                    <div class="row justify-content-center">
                        <div class="col-md-12 col-lg-8">
                            <br>
                            <h5>*หน้าจอจะเเสดงห้องที่ค้างชำระเท่านั้น</h5>
                            <h5>*โปรดติกเลือกห้องที่ต้องการชำระเงินเท่านั้น</h5>

                            <div class="" id="divPostmeterbuildspay" style="margin-top:5%">

                            </div>


                            <form action="" name="formmeterpay" id="formmeterpay" onsubmit="return false">
                                <button name="formmeterpay" type="submit" class="btn btn-primary">ยืนยัน</button>
                            </form>
                            <div id="gggpay">

                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
        <!-- จัดการหอพัก -->
        <div class="tab-pane fade" id="pills-contact4" role="tabpanel" aria-labelledby="pills-contact-tab4">
            <nav>
                <div class="nav nav-tabs" id="nav-tab" role="tablist">
                    <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-unit" role="tab"
                        aria-controls="nav-home" aria-selected="true">หน่วยมิเตอร์</a>
                    {{!-- <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-update" role="tab"
                        aria-controls="nav-profile" aria-selected="false">อัพเดทผังห้อง</a> --}}
                    <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="#nav-set" role="tab"
                        aria-controls="nav-contact" aria-selected="false">เเจ้งปรับปรุง</a>
                    <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="#nav-setbuild" role="tab"
                        aria-controls="nav-contact" aria-selected="false">เเก้ไขข้อมูลหอพัก</a>
                </div>
            </nav>
            <div class="tab-content" id="nav-tabContent">
                <div class="tab-pane fade show active" id="nav-unit" role="tabpanel" aria-labelledby="nav-home-tab">
                    <div class="row">
                        <div class="col-md-6 col-lg-6">
                            <div class="container">
                                <div class="row justify-content-center">
                                    <div class="col-md-12 col-lg-8 ">
                                        <br>
                                        <br>
                                        <br>
                                        <form>
                                            <div class="row justify-content-center">
                                                <div class="col-5">
                                                    <p class="h4">ค่าไฟฟ้าปัจจุบันหน่วยละ</p>
                                                </div>
                                                <div class="col-1">
                                                    <p id="meter"></p>
                                                </div>
                                                <div class="col-3">
                                                    <ul>
                                                        <p class="h4"> บาท</p>
                                                    </ul>
                                                </div>
                                            </div>
                                        </form>
                                        <br>
                                        <br>
                                        <br>
                                        <div class="divform col-md-12 col-lg-12 ">
                                            <form action="" onsubmit="" method="">
                                                <div class="form-group">
                                                    <label for="exampleInputEmail1">อัพเดทค่าไฟฟ้าต่อหน่วย</label>
                                                    <input required name="UnitMeter" type="number" min="1" class="form-control"
                                                        id="UnitMeter" placeholder="" required>
                                                </div>
                                                <div class="form-group">
                                                    <label for="exampleInputPassword1">บาท/หน่วย</label>

                                                </div>
                                                <hr>
                                                <button id="me" type="button" class="btn btn-primary">ยืนยัน</button>
                                                <!-- <button type="button" onclick="SubMit()" class="btn btn-primary">Submit</button> -->
                                            </form>
                                            <div id="setshowunit">

                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-6">
                            <div class="container">
                                <div class="row justify-content-center">
                                    <div class="col-md-12 col-lg-8 ">
                                        <br>
                                        <br>
                                        <br>
                                        <form>
                                            <div class="row justify-content-center">
                                                <div class="col-5">
                                                    <p class="h4">ค่าน้ำปัจจุบันหน่วยละ</p>
                                                </div>
                                                <div class="col-1">
                                                    <p id="water"></p>
                                                </div>
                                                <div class="col-3">
                                                    <ul>
                                                        <p class="h4"> บาท</p>
                                                    </ul>
                                                </div>
                                            </div>
                                        </form>
                                        <br>
                                        <br>
                                        <br>
                                        <div class="divform col-md-12 col-lg-12 ">
                                            <form action="" onsubmit="" method="">
                                                <div class="form-group">
                                                    <label for="exampleInputEmail1">อัพเดทค่าน้าต่อหน่วย</label>
                                                    <input required name="plicewater" type="number" min="1" class="form-control"
                                                        id="plicewater" placeholder="" required>
                                                </div>
                                                <div class="form-group">
                                                    <label for="exampleInputPassword1">บาท/หน่วย</label>

                                                </div>
                                                <hr>
                                                <button id="mewater" type="button" class="btn btn-primary">ยืนยัน</button>
                                                <!-- <button type="button" onclick="SubMit()" class="btn btn-primary">Submit</button> -->
                                            </form>
                                            <div id="setshowunitwater">

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {{!-- อัพเดทผังห้อง --}}
                <div class="tab-pane fade" id="nav-update" role="tabpanel" aria-labelledby="nav-profile-tab">
                    <div class="">
                        <div class="row justify-content-center">
                            <div class="col-md-12 col-lg-8">
                                <br> <br>
                                <p id="setpage"></p>
                                <div class="">
                                    <div id="tablePostedit">
                                        <div id="tablePosteditthead">

                                        </div>

                                    </div>

                                </div>
                            </div>


                        </div>


                    </div>
                </div>
                {{!-- อัพเดทห้องเเจ้งปรับปรุง --}}
                <div class="tab-pane fade" id="nav-set" role="tabpanel" aria-labelledby="nav-contact-tab">
                    <div class="row justify-content-center">
                        <div class="col-md-12 col-lg-8">
                            <br> <br>
                            <div class="">

                                <div id="tablePostUpdate">

                                    <div id="tablePostUpdatebody">

                                    </div>
                                </div>
                                <form action="" name="formUpdate" id="formUpdate" onsubmit="return false">
                                    <button name="formUpdate" type="submit" class="btn btn-primary">บันทึก</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="nav-setbuild" role="tabpanel" aria-labelledby="nav-contact-tab">
                    <div class="container-fluid">
                        <div class="row ">
                            <div class="col-md-12 col-lg-6 divform">
                                <h1>ข้อมูลปัจจุบัน</h1>
                                <label for="exampleInputEmail1">ชื่อหอพัก</label><br>
                                <h4 id="BuildingName" style="margin-left:10%;">dfdfd</h5><br>
                                    <label for="exampleInputEmail1">เบอร์โทรติดต่อหอพัก</label>
                                    <h4 id="BuildingPhone" style="margin-left:10%;">dfdfd</h5><br>
                                        <label for="exampleInputEmail1">emailติดต่อหอพัก</label>
                                        <h4 id="BuildingEmail" style="margin-left:10%;">dfdfd</h5><br>
                            </div>
                            <div class="col-md-12 col-lg-6">
                                <div class="form divform" id="myForm">
                                    <form action="" class="form-container" method="" name="myForm" id="myForm">
                                        <h1>เเก้ไขข้อมูลหอพัก</h1>

                                        <div class="form-group">
                                            <label for="exampleInputEmail1">เบอร์โทรติดต่อหอพัก</label>
                                            <input name="phone" maxlength="10" type="number" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
                                                class="form-control" id="phone" placeholder="เบอร์โทรติดต่อหอพัก">
                                        </div>
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">emailติดต่อหอพัก</label>
                                            <input name="email" type="email" class="form-control" id="email"
                                                placeholder="email ">
                                        </div>

                                        <button id="setName" type="button" class="btn btn-primary">เเก้ไข</button>

                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    </div>
    <script src="https://cdn.anychart.com/releases/8.0.0/js/anychart-base.min.js"></script>
    <script src="https://canvasjs.com/assets/script/jquery-1.11.1.min.js"></script>
    <script src="https://canvasjs.com/assets/script/jquery-ui.1.11.2.min.js"></script>
    <script src="https://canvasjs.com/assets/script/jquery.canvasjs.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
        crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
        let _data
        let _buildingName
        let _dataNow
        let _dataNow2
        function myFunction() {
            alert('Hello');
        }
        function loadPage() {
            // setInterval(function () { alert("Hello"); }, 3000);
            //   $('#navbarTogglerDemo02 a[href="#pills-contact3"]').tab('show') 
        }
        function SendPost(url, jsonData) {
            var xhr = new XMLHttpRequest();
            xhr.open("POST", url, true);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    //  window.location.reload(forceget);
                    window.location.reload(true);
                    //     document.getElementById("setpage").innerHTML = 'เเก้ไข'
                    //   setTimeout(myFunction, 3000)
                    //    $('a[data-toggle="tab"]').on('hidden.bs.tab', function (e) {
                    //  //      localStorage.setItem('activeTab', $(e.target).attr('#pills-contact3'));
                    ////   });
                    //   var activeTab = localStorage.getItem('activeTab');
                    //    if (activeTab) {
                    //      $('#navbarTogglerDemo02 a[href="#pills-contact3"]').tab('show');
                    //  }

                    //console.log('res is', xhr.responseText)
                    //window.location.reload($('#pills-contact4 a[href="#nav-update"]').tab('show'));
                    //  window.location.reload(true);
                    //S alert('dd')
                    //gg  $('#navbarTogglerDemo02 a[href="#pills-contact3"]').tab('show')
                    // $('#nav-contact-tab').foundation('reveal','open');

                    return true

                    // if success go login page
                    //alert('create user Successful ')
                    // window.location.reload(true);
                    //  window.location.href = 'http://localhost:3000/HOME?BuildingName=gg?pills-contact1';

                } else {
                    return false
                    //alert('can not create user! Pls try again.')
                }
            }.bind(this);
            var data = JSON.stringify(jsonData);
            xhr.send(data);
        }

        var node = []
        var member = 0
        function RemoveLink(id) {
            let r = confirm("Do you want to remove the room?");
            if (r == true) {
                let num = id.substring(10);
                console.log('now node is :', num)
                SendPost('https://electricitymeter.herokuapp.com/remove-room', {
                    numIndex: num,
                    buildingNameIndex: _buildingName

                })
            } else {

            }
        }
        //work
        function Plusroom(id) {
            let r = confirm("Do you want to add the room?");
            if (r == true) {
                let index = (id.split('Plusroom')[1]) - 1

                SendPost('https://electricitymeter.herokuapp.com/add-room', {
                    floorIndex: index,
                    buildingNameIndex: _buildingName

                })
            } else {

            }
        }
        $('#newNodeButton').on('click', function () {
            let r = confirm("Do you want to add the floor?");
            if (r == true) {
                SendPost('https://electricitymeter.herokuapp.com/add-floor', {

                    buildingNameIndex: _buildingName

                })
            } else {

            }
        })
        /*
                function AppendNewNode(val1, val2, val3) {
        
                    let appendString =
                        '<div id="blockAppend' + member + '" class="row justify-content-md-center">'
                        + '   <div class="divform"> '
                        + ' <div class="row justify-content-center"> '
                        + '  <div class="col-2 col-sm-2"><br>'
                        + '  <p class="h4">ชั้น</p> '
                        + '   </div> '
                        + '    <div class="col-2 col-sm-2"><br> '
                        + '       <p id="">5</p> '
                        + '        </div> '
                        + '         <div class="col-4 col-sm-3"> '
                        + '           <button onclick="Plusroom(this.id);" id="Plusroom' + member + '" style="margin-top: 6%" class="btn btn-primary " type="button">เพิ่มห้อง</button> '
                        + '       </div> '
                        + '       </div> '
                        + ' <table class="table table-bordered">'
                        + ' <thead>'
                        + '    <tr>'
                        + '      <th scope="col" style="background-color: grey ; height: 50px;">หมายเลขห้อง</th>'
                        + '     <th scope="col" style="background-color: grey">สถานะห้อง</th>'
                        + '     <th scope="col" style="background-color: grey">ลบข้อมูล</th>'
                        + '     </tr>'
                        + '   </thead>'
                        + '   <tbody>'
                        + '  </tbody>'
                        + '  </table>'
                        + '<button onclick="RemoveLink(this.id);" id="' + member + '"type="button" class="btnRemoveLink btn btn-danger btn-block">Remove</button>'
                        + ' </div> '
                        + ' </div> '
        
                    $(appendString).insertBefore('#newNodeButton')
        
                    member++
                } */
        $(document).ready(function () {


            //script หน้าผังห้อง
            var url_string = window.location.href
            var url = new URL(url_string);
            // var username = "{{username}}"
            // var BuildingName = url.searchParams.get("BuildingName");
            var BuildingName = "{{BuildingName}}"
            //     console.log(BuildingName)
            var htmlString1 = '';
            var htmlString = ''
            var htmlStringUserdelete = ''
            var htmlStringedithome = ''
            var htmlStringedithomethead = ''
            var htmlStringUpdate = ''
            var htmlStringUnitMeter = ''
            var htmlStringNow = ''
            _buildingName = BuildingName


            var htmlStringwater = ''

            //ดึงข้อมูล user delete

            /*
                        $(document).on('submit', '#formmeter', function () {
            
                            var meter = document.getElementById("inputmeter").value;
                            console.log(meter)
                            alert('ttt')
                            return false;
                        })
            */
            //-------------------------จดมิเตอร์---------------------
            var now = new Date()
            //  console.log("Current Time is: " + now);
            var currentYear = now.getFullYear()
            //   console.log("Current year is: " + currentYear);
            var month = (now.getMonth() + 1)
            //   console.log("Current month is: " + month);

            document.getElementById("start").innerHTML = currentYear
            if (month == 1) {

                document.getElementById("ShowMonth").innerHTML = 'มกราคม'
                month = '0' + month
            } else if (month == 2) {
                document.getElementById("ShowMonth").innerHTML = 'กุมภาพันธ์'
                month = '0' + month

            } else if (month == 3) {
                document.getElementById("ShowMonth").innerHTML = 'มีนาคม'
                month = '0' + month
            } else if (month == 4) {
                document.getElementById("ShowMonth").innerHTML = 'เมษายน'
                month = '0' + month
            } else if (month == 5) {
                document.getElementById("ShowMonth").innerHTML = 'พฤษภาคม'
                month = '0' + month
            } else if (month == 6) {
                document.getElementById("ShowMonth").innerHTML = 'มิถุนายน'
                month = '0' + month
            } else if (month == 7) {
                document.getElementById("ShowMonth").innerHTML = 'กรกฎาคม'
                month = '0' + month
            } else if (month == 8) {
                document.getElementById("ShowMonth").innerHTML = 'สิงหาคม'
                month = '0' + month
            } else if (month == 9) {
                document.getElementById("ShowMonth").innerHTML = 'กันยายน'
                month = '0' + month
            } else if (month == 10) {
                document.getElementById("ShowMonth").innerHTML = 'ตุลาคม '
            } else if (month == 11) {
                document.getElementById("ShowMonth").innerHTML = 'พฤศจิกายน'
            } else if (month == 12) {
                document.getElementById("ShowMonth").innerHTML = 'ธันวาคม'
            }

            if (month == "01") {

                var beformont = 12
                var beforyear = currentYear - 1
                var befordatemeter = beforyear + "-" + beformont
                befordatemeter = "" + befordatemeter
            } else {

                var beformont = "0" + (parseInt(month) - 1)
                var beforyear = currentYear
                var befordatemeter = beforyear + "-" + beformont
                befordatemeter = "" + befordatemeter
            }


            datemeter = currentYear + "-" + month
            //    console.log('ddd')
            //   console.log(datemeter)
            //    console.log('ddd')
            document.getElementById("ShowYear").innerHTML = currentYear
            datemeter = "" + datemeter
            //render จดมิเตอร์
            //sear data building 
            //เช็คมิเตอร์ก่อนหน้า

            renderpage()
            function renderpage() {
                var ourRequest = new XMLHttpRequest();
                ourRequest.open('GET', 'https://electricitymeter.herokuapp.com/getbuild/' + BuildingName)
                ourRequest.onload = function () {
                    var ourData = JSON.parse(ourRequest.responseText);
                    _data = ourData[0]

                    renderHome(ourData);
                    renderUser(ourData)
                    renderedithome(ourData)
                    makeClick(ourData);
                    renderUpdate(ourData);
                    renderbuttomhome(ourData)


                    // alert('ทำในนี้')
                    //render meter

                    return false;
                }
                ourRequest.send();
            }


            var databefor
            var getdata = []
            getdata.push(BuildingName)
            getdata.push(datemeter)
            getdata.push(befordatemeter)
            console.log('data1', getdata)

            var Request1 = new XMLHttpRequest();
            Request1.open('GET', 'https://electricitymeter.herokuapp.com/getmeter/' + getdata)
            Request1.onload = function () {
                var Datameterunit = JSON.parse(Request1.responseText);
                //   console.log('datanow_', Datameterunit)

                _dataNow = Datameterunit
                console.log('datanowgg_', _dataNow)
                var Request = new XMLHttpRequest();
                Request.open('GET', 'https://electricitymeter.herokuapp.com/getmeterbefor/' + getdata)
                Request.onload = function () {
                    var Datameterbefor = JSON.parse(Request.responseText);
                    //     console.log('databefor_', Datameterbefor)

                    renderPostUnitMeter(Datameterunit, Datameterbefor, datemeter, befordatemeter)
                    console.log('ll', _data.methodwater)

                    renderwater(Datameterunit, Datameterbefor, datemeter, befordatemeter)

                    return false;
                }


                Request.send();
                return false;
            }
            Request1.send();

            var Request = new XMLHttpRequest();
            Request.open('GET', 'https://electricitymeter.herokuapp.com/getmeterbuilds/' + BuildingName)
            Request.onload = function () {
                var Datameterbuilds = JSON.parse(Request.responseText);
                //  console.log('datametebuilds', Datameterbuilds)
                rendermeterbuilds(Datameterbuilds)
                rendermeterbuildspay(Datameterbuilds)
                return false;
            }
            Request.send();
            //   validDate()
            // set date ไม่ให้กรอกวันข้างหน้า

            //  console.log("Current Time is: " + now);

            /*
                        function validDate() {
                            var now = new Date()
                            var month = (now.getMonth() + 1)
                            var monthlast = (now.getMonth() + 2)
                            var today = new Date().toISOString().split('T')[0];
                            var everyday = new Date().toISOString()
            
                            var nextWeekDate = new Date(new Date().getTime() + 6 * 24 * 60 * 60 * 1000).toISOString().split('T')[0]
                            document.getElementsByName("start")[0].setAttribute('min', month);
                            document.getElementsByName("start")[0].setAttribute('max', monthlast)
                        }
            */
            //ดึงข้อมูลของ ห้องพักทุกห้องที่ค้างค่าไฟ้า


            Userdelete()
            //ดึงข้อมูลของ ห้องพักทุกห้องที่ค้างค่าไฟ้า
            function deletete() {
                let a = ""
                document.getElementById("divPostmeterbuildspay").innerHTML = a
                document.getElementById("divPostmeterbuilds").innerHTML = a
                getmeterbuilds()
            }
            function getmeterbuilds() {

                // $("divPostmeterbuildspay").remove();
                // $("divPostmeterbuilds").remove();
                //  alert('ทำด้วยนะ')
                var Request = new XMLHttpRequest();
                Request.open('GET', 'https://electricitymeter.herokuapp.com/getmeterbuilds/' + BuildingName)
                Request.onload = function () {
                    var Datameterbuilds = JSON.parse(Request.responseText);
                    //  console.log('datametebuilds', Datameterbuilds)
                    rendermeterbuilds(Datameterbuilds)
                    rendermeterbuildspay(Datameterbuilds)
                    return false;
                }
                Request.send();
            }
            //render หน้าจ่ายใบเเจ้งหนี้
            function renderbuttomhome(ourData) {
                console.log('_data11 : ', ourData[0].methodwater)
                if (ourData[0].methodwater == "rentunit") {

                    var htmlstringbu = ""
                    htmlstringbu +=
                        ' <a class="nav-item nav-link" id="nav-profile-tab2" data-toggle="tab" href="#nav-saveunit3" role="tab"'
                        + '           aria-controls="nav-profile2" aria-selected="false">บันทึกค่่าน้ำประจำเดือนของหอพัก</a>'
                        + '      <a class="nav-item nav-link" id="nav-profile-tab3" data-toggle="tab" href="#nav-saveunit4" role="tab"'
                        + '         aria-controls="nav-profile2" aria-selected="false">บันทึกค่าน้ำประจำเดือนของหอพัก</a>       '
                    //   document.getElementById("setwater").innerHTML = htmlstringbu
                }
            }
            //ใบเเจ้งหนี้ที่จะเเสดง 
            function rendermeterbuilds(Datameterbuilds) {
                let cou = 0
                var s = Array.from(new Set(Datameterbuilds))
                console.log('datametebuilarray ggwp', s)
                var htmlStringmeterbuilds = ""
                console.log('datametebuildsdddddd', Datameterbuilds)
                for (let l = 0; l < Datameterbuilds.length; l++) {

                    for (let i = 0; i < Datameterbuilds[l].floormeter.length; i++) {

                        for (let j = 0; j < Datameterbuilds[l].floormeter[i].roommeter.length; j++) {
                            let Dateyear = (_data.floor[i].room[j].contract).split('-')[0]
                            let Datemonth = (_data.floor[i].room[j].contract).split('-')[1]
                            let datebuild = Dateyear + "-" + Datemonth + "-01"
                            var date1 = new Date(datebuild)
                            //   console.log('date', date1)
                            var datecount = Datameterbuilds[l].datemeter + "-27"
                            var date2 = new Date((datecount))
                            //   console.log('date2', date2)
                            if (_data.methodwater == "rentunit") {
                                if (Datameterbuilds[l].floormeter[i].roommeter[j].meterstatus == "ค้างชำระ" && Datameterbuilds[l].floormeter[i].roommeter[j].waterstatus == "ค้างชำระ" && _data.floor[i].room[j].roomStatus == 'ไม่ว่าง' && Datameterbuilds[l].floormeter[i].roommeter[j].statusprint != "เคยพริ้น" && date1 <= date2) {
                                    console.log('date', date1)
                                    console.log('date2', date2)
                                    while (cou < 1) {
                                        htmlStringmeterbuilds +=
                                            ' <div  class="row justify-content-md-center">'
                                            + ' <div class="divform">'
                                            + '  <div class="row justify-content-center">'
                                            + '   <div class="col-2 col-sm-2"><br>'
                                            + '       <p class="h4">ประจำเดือนที่</p>'
                                            + '   </div>'
                                            + '   <div class="col-2 col-sm-2"><br>'
                                            + '      <p id="Updatefloor">' + (Datameterbuilds[l].datemeter) + '</p>'
                                            + '   </div>'
                                            + '  </div>'
                                            + '   <table class="table table-bordered" >'
                                            + '  <thead>'
                                            + '     <tr>'
                                            + '     <th scope="col" style="background-color: grey ; height: 50px;"><input type="checkbox" value="' + (l + 1) + '" class="select_allmeter ' + (Datameterbuilds[l].datemeter) + '" id="select_allmeter" ></th>'
                                            + ' <th scope="col" style="background-color: grey">หมายเลขห้อง</th>'
                                            + '     </tr>'
                                        htmlStringmeterbuilds += '  </thead>'
                                        cou = 1
                                    }
                                    htmlStringmeterbuilds += '<tbody > <tr><th scope="row"><input type="checkbox" name="meterRoom" class="checkboxmeter"value="' + (Datameterbuilds[l].datemeter + "," + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter) + '" /></th><td>' + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter + '</th></tr></tbody> '
                                    console.log('มิเตอร์ทำงาน1')
                                }
                            } else if (_data.methodwater == "rentmonth") {
                                if (Datameterbuilds[l].floormeter[i].roommeter[j].meterstatus == "ค้างชำระ" && _data.floor[i].room[j].roomStatus == 'ไม่ว่าง' && Datameterbuilds[l].floormeter[i].roommeter[j].statusprint != "เคยพริ้น") {
                                    while (cou < 1) {
                                        htmlStringmeterbuilds +=
                                            ' <div  class="row justify-content-md-center">'
                                            + ' <div class="divform">'
                                            + '  <div class="row justify-content-center">'
                                            + '   <div class="col-2 col-sm-2"><br>'
                                            + '       <p class="h4">ประจำเดือนที่</p>'
                                            + '   </div>'
                                            + '   <div class="col-2 col-sm-2"><br>'
                                            + '      <p id="Updatefloor">' + (Datameterbuilds[l].datemeter) + '</p>'
                                            + '   </div>'
                                            + '  </div>'
                                            + '   <table class="table table-bordered" >'
                                            + '  <thead>'
                                            + '     <tr>'
                                            + '     <th scope="col" style="background-color: grey ; height: 50px;"><input type="checkbox" value="' + (l + 1) + '" class="select_allmeter ' + (Datameterbuilds[l].datemeter) + '" id="select_allmeter" ></th>'
                                            + ' <th scope="col" style="background-color: grey">หมายเลขห้อง</th>'
                                            + '     </tr>'
                                            + '  </thead>'
                                        cou++
                                    }
                                    htmlStringmeterbuilds += '<tbody > <tr><th scope="row"><input type="checkbox" name="meterRoom" class="checkboxmeter"value="' + (Datameterbuilds[l].datemeter + "," + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter) + '" /></th><td>' + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter + '</th></tr></tbody> '

                                }
                            }
                        }

                    }
                    htmlStringmeterbuilds += '</table></div></div><br>'
                    cou--
                }

                //======

                document.getElementById("divPostmeterbuilds").innerHTML = htmlStringmeterbuilds


                $('.select_allmeter').click(function (e) {
                    //  alert('gg')
                    let setdate = e.target.classList[1]

                    if (this.checked) {
                        $('.checkboxmeter').each(function () {
                            console.log('gdp', this.value)
                            for (let l = 0; l < Datameterbuilds.length; l++) {
                                for (let i = 0; i < Datameterbuilds[0].floormeter.length; i++) {
                                    for (let j = 0; j < Datameterbuilds[0].floormeter[i].roommeter.length; j++) {
                                        if (setdate == (Datameterbuilds[l].datemeter)) {
                                            if (this.value == (Datameterbuilds[l].datemeter + "," + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter)) {
                                                this.checked = true;

                                            }
                                        }
                                    }
                                }
                            }
                        });
                    } else {
                        $('.checkboxmeter').each(function () {
                            this.checked = false;
                        });
                    }
                });
                $('#formmeter').click(function () {
                    console.log('rommetss', Datameterbuilds)
                    let RoomPrint = []
                    let htmlStringmeterprint = ""
                    $.each($("input[name='meterRoom']:checked"), function () {
                        RoomPrint.push($(this).val());
                    });
                    console.log('rommeter', RoomPrint)
                    console.log('rommeterdd', RoomPrint.length)
                    for (let l = 0; l < Datameterbuilds.length; l++) {
                        for (let i = 0; i < Datameterbuilds[l].floormeter.length; i++) {
                            for (let j = 0; j < Datameterbuilds[l].floormeter[i].roommeter.length; j++) {
                                for (let k = 0; k < RoomPrint.length; k++) {
                                    if (RoomPrint[k] == Datameterbuilds[l].floormeter[i].roommeter[j].dateroommeter) {

                                        if (_data.floor[i].room[j].rentroom == undefined || _data.floor[i].room[j].rentroom == "") {
                                            alert('Please return to fill in the room price.')
                                            return false
                                        }

                                    }
                                }
                            }
                        }
                    }
                    {
                        /* for (let l = 0; l < Datameterbuilds.length; l++) {
                            for (let i = 0; i < Datameterbuilds[l].floormeter.length; i++) {
                                for (let j = 0; j < Datameterbuilds[l].floormeter[i].roommeter.length; j++) {
                                    for (let k = 0; k < RoomPrint.length; k++) {
                                        if (RoomPrint[k] == Datameterbuilds[l].floormeter[i].roommeter[j].dateroommeter) {
    
                                            if (_data.floor[i].room[j].rentroom == undefined || _data.floor[i].room[j].rentroom == "") {
                                                alert('Please return to fill in the room price.')
                                                return false
                                            }
                                            for (let a = 0; a < 2; a++) {
                                                if (_data.methodwater == "rentunit") {
                                                    htmlStringmeterprint +=
                                                        ' <div class="container">'
                                                        + '<div class="col-10" >'
                                                        + ' <br>'
                                                        + '         <div class="row">'
                                                        + '           <div class="col-3">'
                                                        + '            </div>'
                                                        + '            <div class="col-5">'
                                                        + '                <h2 style="text-align: center;"> ใบเเจ้งหนี้ (Invoice)</h2>'
                                                        + '            </div>'
                                                        + '<br>'
                                                        + '       </div>'
                                                        + '       <div class="row">'
                                                        + '            <div class="col-7">'
                                                        + '                <h3>ชื่อหอพัก..........' + Datameterbuilds[l].buildingnamemeter + ' </h3>'
                                                        + '            </div>'
                                                        + '         </div>'
                                                        + '       <div class="row">'
                                                        + '            <div class="col-7">'
                                                        + '                <h3>เลขที่ห้องพัก....' + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter + ' </h3>'
                                                        + '            </div>'
                                                        + '         </div>'
                                                        + '          <div class="row">'
                                                        + '             <div class="col-8">'
                                                        + '                 <h3>ประจำเดือน......' + Datameterbuilds[l].datemeter + '</h3>'
                                                        + '              </div>'
                                                        + '          </div>'
                                                        + '           <hr style="border: 1px solid black;">'
                                                        + '              <table class="table table-striped class=" table-primary "">'
                                                        + '                    <thead>'
                                                        + '                    <tr>'
                                                        + '                       <th scope="col-2"></th>'
                                                        + '                      <th scope="col-2">เลขมิเตอร์ก่อนหน้า</th>'
                                                        + '                       <th scope="col-1">เลขมิเตอร์ปัจจุบัน</th>'
                                                        + '                       <th scope="col-2">จำนวนที่ใช้</th>'
                                                        + '                       <th scope="col-2">ราคาต่อหน่วย/บาท</th>'
                                                        + '                       <th scope="col-2">จำนวนเงินที่ต้องจ่าย</th>'
                                                        + '                   </tr>'
                                                        + '               </thead>'
                                                        + '                <tbody>'
                                                        + '                     <tr>'
                                                        + '                         <td>ค่าเช่า</td>'
                                                        + '                         <td></td>'
                                                        + '                          <td></td>'
                                                        + '                           <td></td>'
                                                        + '                          <td></td>'
                                                        + '                            <td style="text-align: right;">' + _data.floor[i].room[j].rentroom + '</td>'
                                                        + '                         </tr>'
                                                        + '                   <tr>'
                                                        + '                       <td>ค่าไฟฟ้า</td>'
                                                        + '                       <td style="text-align: right;">' + Datameterbuilds[l].floormeter[i].roommeter[j].beforusemeter + '</td>'
                                                        + '                        <td style="text-align: right;">' + Datameterbuilds[l].floormeter[i].roommeter[j].usemeter + '</td>'
                                                        + '                        <td style="text-align: right;">' + Datameterbuilds[l].floormeter[i].roommeter[j].usemetermonth + '</td>'
                                                        + '                        <td style="text-align: right;">' + Datameterbuilds[l].pricemeter + '</td>'
                                                        + '                        <td style="text-align: right;">' + (Datameterbuilds[l].floormeter[i].roommeter[j].usemetermonth * Datameterbuilds[l].pricemeter) + '</td>'
                                                        + '                     </tr>'
                                                        + '                   <tr>'
                                                        + '                       <td>ค่าน้ำ</td>'
                                                        + '                       <td style="text-align: right;">' + Datameterbuilds[l].floormeter[i].roommeter[j].beforusewater + '</td>'
                                                        + '                        <td style="text-align: right;">' + Datameterbuilds[l].floormeter[i].roommeter[j].usewater + '</td>'
                                                        + '                        <td style="text-align: right;">' + Datameterbuilds[l].floormeter[i].roommeter[j].usewatermonth + '</td>'
                                                        + '                        <td style="text-align: right;">' + Datameterbuilds[l].pricemeter + '</td>'
                                                        + '                        <td style="text-align:right;">' + (Datameterbuilds[l].floormeter[i].roommeter[j].usewatermonth * Datameterbuilds[l].pricewater) + '</td>'
                                                        + '                     </tr>'
                                                        + '                   </tbody>'
                                                        + '                             </table>'
                                                        + '                <hr style="border: 1px solid black;">'
                                                        + '                    <div class="row">'
                                                        + '                        <div class="col-7">'
                                                        + '<br>'
                                                        + '                           <h4>รวมทั้งสิ้น ' + (_data.floor[i].room[j].rentroom + (Datameterbuilds[l].floormeter[i].roommeter[j].usemetermonth * Datameterbuilds[l].pricemeter) + (Datameterbuilds[l].floormeter[i].roommeter[j].usewatermonth * Datameterbuilds[l].pricewater)) + ' บาท </h4>'
                                                        + '                        </div>'
                                                        + '                      </div>'
                                                    htmlStringmeterprint += ' </div>'
                                                        + '<br>'
                                                    htmlStringmeterprint += ' <hr style="border: 1px solid black;">'
                                                    htmlStringmeterprint += '<br>'
                                                } else {
                                                    htmlStringmeterprint +=
                                                        ' <div class="container">'
                                                        + '<div class="col-10" >'
                                                        + ' <br>'
                                                        + '         <div class="row">'
                                                        + '           <div class="col-3">'
                                                        + '            </div>'
                                                        + '            <div class="col-5">'
                                                        + '                <h2 style="text-align: right;"> ใบเเจ้งหนี้ (Invoice)</h2>'
                                                        + '            </div>'
                                                        + '<br>'
                                                        + '       </div>'
                                                        + '       <div class="row">'
                                                        + '            <div class="col-7">'
                                                        + '                <h3>ชื่อหอพัก..........' + Datameterbuilds[l].buildingnamemeter + ' </h3>'
                                                        + '            </div>'
                                                        + '         </div>'
                                                        + '       <div class="row">'
                                                        + '            <div class="col-7">'
                                                        + '                <h3>เลขที่ห้องพัก....' + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter + ' </h3>'
                                                        + '            </div>'
                                                        + '         </div>'
                                                        + '          <div class="row">'
                                                        + '             <div class="col-8">'
                                                        + '                 <h3>ประจำเดือน......' + Datameterbuilds[l].datemeter + '</h3>'
                                                        + '              </div>'
                                                        + '          </div>'
                                                        + '           <hr style="border: 1px solid black;">'
                                                        + '              <table class="table table-striped class=" table-primary "">'
                                                        + '                    <thead>'
                                                        + '                    <tr>'
                                                        + '                       <th scope="col-2"></th>'
                                                        + '                      <th scope="col-2">เลขมิเตอร์ก่อนหน้า</th>'
                                                        + '                       <th scope="col-1">เลขมิเตอร์ปัจจุบัน</th>'
                                                        + '                       <th scope="col-2">จำนวนที่ใช้</th>'
                                                        + '                       <th scope="col-2">ราคาต่อหน่วย/บาท</th>'
                                                        + '                       <th scope="col-2">จำนวนเงินที่ต้องจ่าย</th>'
                                                        + '                   </tr>'
                                                        + '               </thead>'
                                                        + '                <tbody>'
                                                        + '                     <tr>'
                                                        + '                         <td>ค่าเช่า</td>'
                                                        + '                         <td></td>'
                                                        + '                          <td></td>'
                                                        + '                           <td></td>'
                                                        + '                          <td></td>'
                                                        + '                            <td style="text-align:right;">' + _data.floor[i].room[j].rentroom + '</td>'
                                                        + '                         </tr>'
                                                        + '                   <tr>'
                                                        + '                       <td>ค่าไฟฟ้า</td>'
                                                        + '                       <td style="text-align: right;">' + Datameterbuilds[l].floormeter[i].roommeter[j].beforusemeter + '</td>'
                                                        + '                        <td style="text-align: right;">' + Datameterbuilds[l].floormeter[i].roommeter[j].usemeter + '</td>'
                                                        + '                        <td style="text-align: right;">' + Datameterbuilds[l].floormeter[i].roommeter[j].usemetermonth + '</td>'
                                                        + '                        <td style="text-align: right;">' + Datameterbuilds[l].pricemeter + '</td>'
                                                        + '                        <td style="text-align: right;">' + (Datameterbuilds[l].floormeter[i].roommeter[j].usemetermonth * Datameterbuilds[l].pricemeter) + '</td>'
                                                        + '                     </tr>'
                                                        + '                   <tr>'
                                                        + '                       <td>ค่าน้ำ</td>'
                                                        + '                       <td></td>'
                                                        + '                        <td></td>'
                                                        + '                        <td></td>'
                                                        + '                        <td></td>'
                                                        + '                        <td style="text-align: right;">' + Datameterbuilds[l].pricewater + '</td>'
                                                        + '                     </tr>'
                                                        + '                   </tbody>'
                                                        + '                             </table>'
                                                        + '                <hr style="border: 1px solid black;">'
                                                        + '                    <div class="row">'
                                                        + '                        <div class="col-7">'
                                                        + '<br>'
                                                        + '                           <h4>รวมทั้งสิ้น ' + (_data.floor[i].room[j].rentroom + (Datameterbuilds[l].floormeter[i].roommeter[j].usemetermonth * Datameterbuilds[l].pricemeter) + (Datameterbuilds[l].pricewater)) + ' บาท </h4>'
                                                        + '                        </div>'
                                                        + '                      </div>'
                                                    htmlStringmeterprint += ' </div>'
                                                        + '<br>'
                                                    htmlStringmeterprint += ' <hr style="border: 1px solid black;">'
                                                    htmlStringmeterprint += '<br>'
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        } */
                    }

                    //  document.getElementById("ggg").innerHTML = htmlStringmeterprint

                    console.log('ใบเเจ้งหนี้ชื่อหอพัก', BuildingName)
                    var url = "https://electricitymeter.herokuapp.com/postPrint";
                    var xhr = new XMLHttpRequest();
                    xhr.open("POST", url, true);
                    xhr.setRequestHeader("Content-Type", "application/json");
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState === 4 && xhr.status === 200) {
                            console.log('res isใบเเจ้งหนี้', xhr.responseText)
                            // if success go login page
                            alert('create Successfullllll ใบเเจ้งหนี้ ')
                            //    window.location.reload(true);
                            window.open('https://electricitymeter.herokuapp.com/print', '_blank');
                            // location.href = 'http://localhost:3000/print';
                            // window.location.href = 'http://localhost:3000/print';
                        } else {
                            // alert('fail ใบเเจ้งหนี้')
                        }
                    };
                    var data = JSON.stringify({
                        RoomPrint, BuildingName, Datameterbuilds, methodwater: _data.methodwater
                    });
                    xhr.send(data);
                });

            }
            //ใบเสร็จรับเงิน
            function rendermeterbuildspay(Datameterbuilds) {
                let cou = 0
                var htmlStringmeterbuildspay = ''
                console.log('datametebuilds', Datameterbuilds)
                for (let l = 0; l < Datameterbuilds.length; l++) {

                    for (let i = 0; i < Datameterbuilds[l].floormeter.length; i++) {

                        for (let j = 0; j < Datameterbuilds[l].floormeter[i].roommeter.length; j++) {
                            if (Datameterbuilds[l].floormeter[i].roommeter[j].meterstatus == "ค้างชำระ" && Datameterbuilds[l].floormeter[i].roommeter[j].waterstatus == "ค้างชำระ" && _data.floor[i].room[j].roomStatus == 'ไม่ว่าง' && Datameterbuilds[l].floormeter[i].roommeter[j].statusprint != "เคยพริ้น") {
                                while (cou < 1) {
                                    htmlStringmeterbuildspay +=
                                        ' <div  class="row justify-content-md-center">'
                                        + ' <div class="divform">'
                                        + '  <div class="row justify-content-center">'
                                        + '   <div class="col-2 col-sm-2"><br>'
                                        + '       <p class="h4">ประจำเดือนที่</p>'
                                        + '   </div>'
                                        + '   <div class="col-2 col-sm-2"><br>'
                                        + '      <p id="Updatefloor">' + (Datameterbuilds[l].datemeter) + '</p>'
                                        + '   </div>'
                                        + '  </div>'
                                        + '   <table class="table table-bordered" >'
                                        + '  <thead>'
                                        + '     <tr>'
                                        + '     <th scope="col" style="background-color: grey ; height: 50px;"><input type="checkbox" value="' + (l + 1) + '" class="select_allmeterpay ' + (Datameterbuilds[l].datemeter) + '" id="select_allmeterpay" ></th>'
                                        + ' <th scope="col" style="background-color: grey">หมายเลขห้อง</th>'
                                        + '     </tr>'
                                        + '  </thead>'
                                    cou++
                                }
                                htmlStringmeterbuildspay += '<tbody > <tr><th scope="row"><input type="checkbox" name="meterRoom" class="checkboxmeterpay"value="' + (Datameterbuilds[l].datemeter + "," + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter) + '" /></th><td>' + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter + '</th></tr></tbody> '

                            } else if (_data.methodwater == "rentmonth") {
                                if (Datameterbuilds[l].floormeter[i].roommeter[j].meterstatus == "ค้างชำระ" && _data.floor[i].room[j].roomStatus == 'ไม่ว่าง' && Datameterbuilds[l].floormeter[i].roommeter[j].statusprint != "เคยพริ้น") {
                                    while (cou < 1) {
                                        htmlStringmeterbuildspay +=
                                            ' <div  class="row justify-content-md-center">'
                                            + ' <div class="divform">'
                                            + '  <div class="row justify-content-center">'
                                            + '   <div class="col-2 col-sm-2"><br>'
                                            + '       <p class="h4">ประจำเดือนที่</p>'
                                            + '   </div>'
                                            + '   <div class="col-2 col-sm-2"><br>'
                                            + '      <p id="Updatefloor">' + (Datameterbuilds[l].datemeter) + '</p>'
                                            + '   </div>'
                                            + '  </div>'
                                            + '   <table class="table table-bordered" >'
                                            + '  <thead>'
                                            + '     <tr>'
                                            + '     <th scope="col" style="background-color: grey ; height: 50px;"><input type="checkbox" value="' + (l + 1) + '" class="select_allmeterpay ' + (Datameterbuilds[l].datemeter) + '" id="select_allmeterpay" ></th>'
                                            + ' <th scope="col" style="background-color: grey">หมายเลขห้อง</th>'
                                            + '     </tr>'
                                            + '  </thead>'
                                        cou++
                                    }
                                    htmlStringmeterbuildspay += '<tbody > <tr><th scope="row"><input type="checkbox" name="meterRoom" class="checkboxmeter"value="' + (Datameterbuilds[l].datemeter + "," + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter) + '" /></th><td>' + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter + '</th></tr></tbody> '

                                }
                            }
                        }

                    }
                    htmlStringmeterbuildspay += '</table></div></div><br>'
                    cou--
                }

                document.getElementById("divPostmeterbuildspay").innerHTML = htmlStringmeterbuildspay
                $('.select_allmeterpay').click(function (e) {
                    //  alert('gg')
                    let setdate = e.target.classList[1]

                    if (this.checked) {
                        $('.checkboxmeterpay').each(function () {
                            console.log('gdp', this.value)
                            for (let l = 0; l < Datameterbuilds.length; l++) {
                                for (let i = 0; i < Datameterbuilds[0].floormeter.length; i++) {
                                    for (let j = 0; j < Datameterbuilds[0].floormeter[i].roommeter.length; j++) {
                                        if (setdate == (Datameterbuilds[l].datemeter)) {
                                            if (this.value == (Datameterbuilds[l].datemeter + "," + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter)) {
                                                this.checked = true;

                                            }
                                        }
                                    }
                                }
                            }
                        });
                    } else {
                        $('.checkboxmeterpay').each(function () {
                            this.checked = false;
                        });
                    }
                });
                $('#formmeterpay').click(function () {

                    var r = confirm("ยินยันการจ่ายเงิน");
                    if (r == true) {
                        console.log('rommetss', Datameterbuilds)
                        let RoomPrint = []
                        let htmlStringmeterprintpay = ""
                        $.each($("input[name='meterRoom']:checked"), function () {
                            RoomPrint.push($(this).val());
                        });

                        console.log('rommeter', RoomPrint)
                        console.log('rommeterdd', RoomPrint.length)
                        for (let l = 0; l < Datameterbuilds.length; l++) {
                            for (let i = 0; i < Datameterbuilds[l].floormeter.length; i++) {
                                for (let j = 0; j < Datameterbuilds[l].floormeter[i].roommeter.length; j++) {
                                    for (let k = 0; k < RoomPrint.length; k++) {
                                        if (RoomPrint[k] == Datameterbuilds[l].floormeter[i].roommeter[j].dateroommeter) {
                                            if (_data.floor[i].room[j].rentroom == undefined || _data.floor[i].room[j].rentroom == "") {
                                                alert('Please return to fill in the room price.')
                                                return false
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        /*for (let l = 0; l < Datameterbuilds.length; l++) {
                            for (let i = 0; i < Datameterbuilds[l].floormeter.length; i++) {
                                for (let j = 0; j < Datameterbuilds[l].floormeter[i].roommeter.length; j++) {
                                    for (let k = 0; k < RoomPrint.length; k++) {
                                        if (RoomPrint[k] == Datameterbuilds[l].floormeter[i].roommeter[j].dateroommeter) {
                                            if (_data.floor[i].room[j].rentroom == undefined || _data.floor[i].room[j].rentroom == "") {
                                                alert('Please return to fill in the room price.')
                                                return false
                                            }
                                            if (_data.methodwater == "rentunit") {

                                                console.log('failroomnumssdsdsd===eterssssssgg', _data.floor[i].room[j].rentroom)
                                                htmlStringmeterprintpay +=
                                                    ' <div class="container">'
                                                    + '<div class="col-10" >'
                                                    + '         <div class="row">'
                                                    + '           <div class="col-3">'
                                                    + '            </div>'
                                                    + '            <div class="col-5">'
                                                    + '                <h2 style="text-align: center;"> ใบเสร็จรับเงิน (Receipt)</h2>'
                                                    + '            </div>'
                                                    + '<br>'
                                                    + '       </div>'
                                                    + '       <div class="row">'
                                                    + '            <div class="col-7">'
                                                    + '                <h3>ชื่อหอพัก..........' + Datameterbuilds[l].buildingnamemeter + ' </h3>'
                                                    + '            </div>'
                                                    + '         </div>'
                                                    + '       <div class="row">'
                                                    + '            <div class="col-7">'
                                                    + '                <h3>เลขที่ห้องพัก....' + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter + ' </h3>'
                                                    + '            </div>'
                                                    + '         </div>'
                                                    + '          <div class="row">'
                                                    + '             <div class="col-8">'
                                                    + '                 <h3>ประจำเดือน......' + Datameterbuilds[l].datemeter + '</h3>'
                                                    + '              </div>'
                                                    + '          </div>'
                                                    + '           <hr style="border: 1px solid black;">'
                                                    + '              <table class="table table-striped class=" table-primary "">'
                                                    + '                    <thead>'
                                                    + '                    <tr>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2">จำนวนเงินที่ต้องจ่าย</th>'
                                                    + '                   </tr>'
                                                    + '               </thead>'
                                                    + '                <tbody>'
                                                    + '                     <tr>'
                                                    + '                         <td>ค่าเช่า</td>'
                                                    + '                         <td></td>'
                                                    + '                          <td></td>'
                                                    + '                           <td></td>'
                                                    + '                          <td></td>'
                                                    + '                            <td style="text-align: right;">' + _data.floor[i].room[j].rentroom + '</td>'
                                                    + '                         </tr>'
                                                    + '                   <tr>'
                                                    + '                       <td>ค่าไฟฟ้า</td>'
                                                    + '                       <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td style="text-align: right;">' + (Datameterbuilds[l].floormeter[i].roommeter[j].usemetermonth * Datameterbuilds[l].pricemeter) + '</td>'
                                                    + '                     </tr>'
                                                    + '                   <tr>'
                                                    + '                       <td>ค่าน้ำ</td>'
                                                    + '                       <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td style="text-align: right;">' + (Datameterbuilds[l].floormeter[i].roommeter[j].usewatermonth * Datameterbuilds[l].pricewater) + '</td>'
                                                    + '                     </tr>'
                                                    + '                   </tbody>'
                                                    + '                             </table>'
                                                    + '                <hr style="border: 1px solid black;">'
                                                    + '                    <div class="row">'
                                                    + '                        <div class="col-8">'
                                                    + '                           <h4>รวมทั้งสิ้น ' + (_data.floor[i].room[j].rentroom + (Datameterbuilds[l].floormeter[i].roommeter[j].usemetermonth * Datameterbuilds[l].pricemeter) + (Datameterbuilds[l].floormeter[i].roommeter[j].usewatermonth * Datameterbuilds[l].pricewater)) + ' บาท </h4>'
                                                    + '                <h5 style="margin-left:300px"> ลงชื่อ...................................ผู้รับเงิน</h5>'
                                                    + '                <h5 style="margin-left:300px"> (.......................................................)</h5>'
                                                    + '                        </div>'
                                                    + '                      </div>'
                                                    + ' </div>'
                                                    + ' <hr style="border: 1px solid black;">'
                                                    + '<br>'
                                                    + ' <div class="container">'
                                                    + '<div class="col-10" >'
                                                    + '         <div class="row">'
                                                    + '           <div class="col-3">'
                                                    + '            </div>'
                                                    + '            <div class="col-5">'
                                                    + '                <h2 style="text-align: center;"> ใบเสร็จรับเงิน (Receipt)</h2>'
                                                    + '            </div>'
                                                    + '<br>'
                                                    + '       </div>'
                                                    + '       <div class="row">'
                                                    + '            <div class="col-7">'
                                                    + '                <h3>ชื่อหอพัก..........' + Datameterbuilds[l].buildingnamemeter + ' </h3>'
                                                    + '            </div>'
                                                    + '         </div>'
                                                    + '       <div class="row">'
                                                    + '            <div class="col-7">'
                                                    + '                <h3>เลขที่ห้องพัก....' + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter + ' </h3>'
                                                    + '            </div>'
                                                    + '         </div>'
                                                    + '          <div class="row">'
                                                    + '             <div class="col-8">'
                                                    + '                 <h3>ประจำเดือน......' + Datameterbuilds[l].datemeter + '</h3>'
                                                    + '              </div>'
                                                    + '          </div>'
                                                    + '           <hr style="border: 1px solid black;">'
                                                    + '              <table class="table table-striped class=" table-primary "">'
                                                    + '                    <thead>'
                                                    + '                    <tr>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2">จำนวนเงินที่ต้องจ่าย</th>'
                                                    + '                   </tr>'
                                                    + '               </thead>'
                                                    + '                <tbody>'
                                                    + '                     <tr>'
                                                    + '                         <td>ค่าเช่า</td>'
                                                    + '                         <td></td>'
                                                    + '                          <td></td>'
                                                    + '                           <td></td>'
                                                    + '                          <td></td>'
                                                    + '                            <td style="text-align: right;">' + _data.floor[i].room[j].rentroom + '</td>'
                                                    + '                         </tr>'
                                                    + '                   <tr>'
                                                    + '                       <td>ค่าไฟฟ้า</td>'
                                                    + '                       <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td style="text-align: right;">' + (Datameterbuilds[l].floormeter[i].roommeter[j].usemetermonth * Datameterbuilds[l].pricemeter) + '</td>'
                                                    + '                     </tr>'
                                                    + '                   <tr>'
                                                    + '                       <td>ค่าน้ำ</td>'
                                                    + '                       <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td style="text-align:right;">' + (Datameterbuilds[l].floormeter[i].roommeter[j].usewatermonth * Datameterbuilds[l].pricewater) + '</td>'
                                                    + '                     </tr>'
                                                    + '                   </tbody>'
                                                    + '                             </table>'
                                                    + '                <hr style="border: 1px solid black;">'
                                                    + '                    <div class="row">'
                                                    + '                        <div class="col-8">'
                                                    + '                           <h4>รวมทั้งสิ้น ' + (_data.floor[i].room[j].rentroom + (Datameterbuilds[l].floormeter[i].roommeter[j].usemetermonth * Datameterbuilds[l].pricemeter) + (Datameterbuilds[l].floormeter[i].roommeter[j].usewatermonth * Datameterbuilds[l].pricewater)) + ' บาท </h4>'
                                                    + '                <h5 style="margin-left:300px"> ลงชื่อ...................................ผู้รับเงิน</h5>'
                                                    + '                <h5 style="margin-left:300px"> (.......................................................)</h5>'
                                                    + '                        </div>'
                                                    + '                      </div>'
                                                htmlStringmeterprintpay += ' </div>'
                                                htmlStringmeterprintpay += ' <hr style="border: 1px solid black;">'
                                                htmlStringmeterprintpay += '<br>'

                                            } else {
                                                htmlStringmeterprintpay +=
                                                    ' <div class="container">'
                                                    + '<div class="col-10" >'
                                                    + '         <div class="row">'
                                                    + '           <div class="col-3">'
                                                    + '            </div>'
                                                    + '            <div class="col-5">'
                                                    + '                <h2 style="text-align: center;"> ใบเสร็จรับเงิน (Receipt)</h2>'
                                                    + '            </div>'
                                                    + '<br>'
                                                    + '       </div>'
                                                    + '       <div class="row">'
                                                    + '            <div class="col-7">'
                                                    + '                <h3>ชื่อหอพัก..........' + Datameterbuilds[l].buildingnamemeter + ' </h3>'
                                                    + '            </div>'
                                                    + '         </div>'
                                                    + '       <div class="row">'
                                                    + '            <div class="col-7">'
                                                    + '                <h3>เลขที่ห้องพัก....' + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter + ' </h3>'
                                                    + '            </div>'
                                                    + '         </div>'
                                                    + '          <div class="row">'
                                                    + '             <div class="col-8">'
                                                    + '                 <h3>ประจำเดือน......' + Datameterbuilds[l].datemeter + '</h3>'
                                                    + '              </div>'
                                                    + '          </div>'
                                                    + '           <hr style="border: 1px solid black;">'
                                                    + '              <table class="table table-striped class=" table-primary "">'
                                                    + '                    <thead>'
                                                    + '                    <tr>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2">จำนวนเงินที่ต้องจ่าย</th>'
                                                    + '                   </tr>'
                                                    + '               </thead>'
                                                    + '                <tbody>'
                                                    + '                     <tr>'
                                                    + '                         <td>ค่าเช่า</td>'
                                                    + '                         <td></td>'
                                                    + '                          <td></td>'
                                                    + '                           <td></td>'
                                                    + '                          <td></td>'
                                                    + '                            <td style="text-align: right;">' + _data.floor[i].room[j].rentroom + '</td>'
                                                    + '                         </tr>'
                                                    + '                   <tr>'
                                                    + '                       <td>ค่าไฟฟ้า</td>'
                                                    + '                       <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td style="text-align:right;">' + (Datameterbuilds[l].floormeter[i].roommeter[j].usemetermonth * Datameterbuilds[l].pricemeter) + '</td>'
                                                    + '                     </tr>'
                                                    + '                   <tr>'
                                                    + '                       <td>ค่าน้ำ</td>'
                                                    + '                       <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td style="text-align: right;">' + (Datameterbuilds[l].pricewater) + '</td>'
                                                    + '                     </tr>'
                                                    + '                   </tbody>'
                                                    + '                             </table>'
                                                    + '                <hr style="border: 1px solid black;">'
                                                    + '                    <div class="row">'
                                                    + '                        <div class="col-8">'
                                                    + '                           <h4>รวมทั้งสิ้น ' + (_data.floor[i].room[j].rentroom + (Datameterbuilds[l].floormeter[i].roommeter[j].usemetermonth * Datameterbuilds[l].pricemeter) + (Datameterbuilds[l].pricewater)) + ' บาท </h4>'
                                                    + '                <h5 style="margin-left:300px"> ลงชื่อ...................................ผู้รับเงิน</h5>'
                                                    + '                <h5 style="margin-left:300px"> (.......................................................)</h5>'
                                                    + '                        </div>'
                                                    + '                      </div>'
                                                    + ' </div>'
                                                    + ' <hr style="border: 1px solid black;">'
                                                    + '<br>'
                                                    + ' <div class="container">'
                                                    + '<div class="col-10" >'
                                                    + '         <div class="row">'
                                                    + '           <div class="col-3">'
                                                    + '            </div>'
                                                    + '            <div class="col-5">'
                                                    + '                <h2 style="text-align: center;"> ใบเสร็จรับเงิน (Receipt)</h2>'
                                                    + '            </div>'
                                                    + '<br>'
                                                    + '       </div>'
                                                    + '       <div class="row">'
                                                    + '            <div class="col-7">'
                                                    + '                <h3>ชื่อหอพัก..........' + Datameterbuilds[l].buildingnamemeter + ' </h3>'
                                                    + '            </div>'
                                                    + '         </div>'
                                                    + '       <div class="row">'
                                                    + '            <div class="col-7">'
                                                    + '                <h3>เลขที่ห้องพัก....' + Datameterbuilds[l].floormeter[i].roommeter[j].roomNumbermeter + ' </h3>'
                                                    + '            </div>'
                                                    + '         </div>'
                                                    + '          <div class="row">'
                                                    + '             <div class="col-8">'
                                                    + '                 <h3>ประจำเดือน......' + Datameterbuilds[l].datemeter + '</h3>'
                                                    + '              </div>'
                                                    + '          </div>'
                                                    + '           <hr style="border: 1px solid black;">'
                                                    + '              <table class="table table-striped class=" table-primary "">'
                                                    + '                    <thead>'
                                                    + '                    <tr>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2"></th>'
                                                    + '                       <th scope="col-2">จำนวนเงินที่ต้องจ่าย</th>'
                                                    + '                   </tr>'
                                                    + '               </thead>'
                                                    + '                <tbody>'
                                                    + '                     <tr>'
                                                    + '                         <td>ค่าเช่า</td>'
                                                    + '                         <td></td>'
                                                    + '                          <td></td>'
                                                    + '                           <td></td>'
                                                    + '                          <td></td>'
                                                    + '                            <td style="text-align: right;">' + _data.floor[i].room[j].rentroom + '</td>'
                                                    + '                         </tr>'
                                                    + '                   <tr>'
                                                    + '                       <td>ค่าไฟฟ้า</td>'
                                                    + '                       <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td style="text-align: right;">' + (Datameterbuilds[l].floormeter[i].roommeter[j].usemetermonth * Datameterbuilds[l].pricemeter) + '</td>'
                                                    + '                     </tr>'
                                                    + '                   <tr>'
                                                    + '                       <td>ค่าน้ำ</td>'
                                                    + '                       <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td></td>'
                                                    + '                        <td style="text-align: right;">' + (Datameterbuilds[l].pricewater) + '</td>'
                                                    + '                     </tr>'
                                                    + '                   </tbody>'
                                                    + '                             </table>'
                                                    + '                <hr style="border: 1px solid black;">'
                                                    + '                    <div class="row">'
                                                    + '                        <div class="col-8">'
                                                    + '                           <h4>รวมทั้งสิ้น ' + (_data.floor[i].room[j].rentroom + (Datameterbuilds[l].floormeter[i].roommeter[j].usemetermonth * Datameterbuilds[l].pricemeter) + (Datameterbuilds[l].pricewater)) + ' บาท </h4>'
                                                    + '                <h5 style="margin-left:300px"> ลงชื่อ...................................ผู้รับเงิน</h5>'
                                                    + '                <h5 style="margin-left:300px"> (.......................................................)</h5>'
                                                    + '                        </div>'
                                                    + '                      </div>'
                                                htmlStringmeterprintpay += ' </div>'
                                                htmlStringmeterprintpay += ' <hr style="border: 1px solid black;">'
                                                htmlStringmeterprintpay += '<br>'
                                            }

                                        }
                                    }
                                }
                            }
                        } */

                        // document.getElementById("gggpay").innerHTML = htmlStringmeterprintpay

                        //  console.log('ใบเสร็จรับเงิน', htmlStringmeterprintpay)
                        //   console.log('rommeterใบเสร้จ', RoomPrint)
                        //  console.log('ชื่อหอใบเสร้จ', Datameterbuilds[0].buildingnamemeter)
                        //   console.log('#############')
                        //    console.log(RoomPrint)
                        //    console.log(BuildingName)
                        //    console.log(Datameterbuilds)
                        //    console.log(_data.methodwater)
                        //    console.log('#############')
                        var url = "https://electricitymeter.herokuapp.com/postPrintpay";
                        var xhr = new XMLHttpRequest();
                        xhr.open("POST", url, true);
                        xhr.setRequestHeader("Content-Type", "application/json");
                        xhr.onreadystatechange = function () {
                            if (xhr.readyState === 4 && xhr.status === 200) {
                                console.log('res is', xhr.responseText)
                                // if success go login page
                                alert('create  Successfully ')
                                window.open('https://electricitymeter.herokuapp.com/printt', '_blank');
                                //    window.location.reload(true);
                                //  window.location.href = 'http://127.0.0.1:5500/somelogin.html';

                                deletete()
                                //  getmeterbuilds()

                            } else {
                                //alert('can not create user! Pls try again.')
                            }
                        };
                        var data = JSON.stringify({
                            RoomPrint, BuildingName, Datameterbuilds, methodwater: _data.methodwater
                        });
                        xhr.send(data);
                    } else {

                    }
                });

            }
            $('#start').on('input', function (e) {
                //     $("#tablePostUnitMeter").remove();
                var currentVal = document.getElementById("start").value;
                alert(currentVal)
                document.getElementById("ShowMonth").innerHTML = ''
                document.getElementById("ShowYear").innerHTML = currentVal
                // console.log('ปัจจุบัน',currentVal)
                datemeter = "" + currentVal
                // console.log('ปัจจุบันสตริง', datemeter)
                let beforyear = ""
                let beformont = ""
                let i = 0
                while (datemeter[i] != "-") {
                    beforyear = beforyear + datemeter[i]
                    i++;
                }
                i++
                while (i < datemeter.length) {
                    beformont = beformont + datemeter[i]
                    i++;
                }
                //   console.log('ปัจจุบันmont', beformont)
                //     console.log('ปัจจุบันyear',  beforyear)
                if (beformont == "01") {
                    alert('ทำ1')
                    beformont = "12"
                    beforyear = "" + (parseInt(beforyear) - 1)
                    var befordatemeter = beforyear + "-" + beformont
                    befordatemeter = "" + befordatemeter
                } else {
                    alert('ทำ2')
                    beformont = "0" + (parseInt(beformont) - 1)
                    beforyear = beforyear
                    var befordatemeter = beforyear + "-" + beformont
                    befordatemeter = "" + befordatemeter
                }
                console.log('databeformont', beformont)
                console.log('databeforyear', beforyear)
                console.log('databeforsome', befordatemeter)
                var getdata = []
                getdata.push(BuildingName)
                getdata.push(datemeter)
                getdata.push(befordatemeter)
                //     console.log('data2ก่อนส่ง', getdata)
                getDataMeter(getdata, datemeter, befordatemeter)
                return false
            })

            function getDataMeter(getdata, datemeter, befordatemeter) {

                //     console.log('data2ส่งมา', getdata)
                var Request1 = new XMLHttpRequest();
                Request1.open('GET', 'https://electricitymeter.herokuapp.com/getmeter/' + getdata)
                Request1.onload = function () {
                    var Datameterunit = JSON.parse(Request1.responseText);
                    //  console.log('datanow2_', Datameterunit)

                    _dataNow2 = Datameterunit
                    console.log('datanow_change', _dataNow2)
                    return false;
                }
                Request1.send();

                var Request = new XMLHttpRequest();
                Request.open('GET', 'https://electricitymeter.herokuapp.com/getmeterbefor/' + getdata)
                Request.onload = function () {
                    var Datameterbefor = JSON.parse(Request.responseText);
                    console.log('databefor2_change', Datameterbefor)

                    renderPostUnitMeter(_dataNow2, Datameterbefor, datemeter, befordatemeter)

                    renderwater(_dataNow2, Datameterbefor, datemeter, befordatemeter)

                    return false;
                }
                Request.send();
            }

            $('#me').click(function () {

                if (document.getElementById('UnitMeter').value == "") {
                    alert('Please Input Unitmeter');
                    return false;
                } else if (document.getElementById('UnitMeter').value <= 0) {
                    alert('Please Input Unitmeter');
                    return false;
                }
                var nowdate = new Date()
                var UnitMeter = document.getElementById("UnitMeter").value;
                var dataUnit = {
                    UnitMeter, BuildingName,
                }
                var url = "https://electricitymeter.herokuapp.com/postUnitmeter";
                var xhr = new XMLHttpRequest();
                xhr.open("POST", url, true);
                xhr.setRequestHeader("Content-Type", "application/json");
                xhr.onreadystatechange = function () {
                    if (xhr.readyState === 4 && xhr.status === 200) {
                        console.log('res is', xhr.responseText)
                        // if success go login page
                        alert('create user Successful ')
                        //  window.location.reload(true);
                        setshowunit(nowdate)
                        renderpage()
                        //  window.location.href = 'http://127.0.0.1:5500/somelogin.html';

                    } else {
                        //alert('can not create user! Pls try again.')
                    }
                };
                var data = JSON.stringify({
                    UnitMeter: dataUnit.UnitMeter, BuildingName: dataUnit.BuildingName, nowdate: nowdate
                });
                xhr.send(data);


            })
            $('#mewater').click(function () {

                if (document.getElementById('plicewater').value == "") {
                    alert('Please Input Unitwater');
                    return false;
                } else if (document.getElementById('plicewater').value <= 0) {
                    alert('Please Input Unitwater');
                    return false;
                }
                var nowdate = new Date()
                var plicewater = document.getElementById("plicewater").value;
                var dataUnit = {
                    plicewater, BuildingName,
                }
                console.log('dataunitwater', dataUnit)
                var url = "https://electricitymeter.herokuapp.com/postUnitwater";
                var xhr = new XMLHttpRequest();
                xhr.open("POST", url, true);
                xhr.setRequestHeader("Content-Type", "application/json");
                xhr.onreadystatechange = function () {
                    if (xhr.readyState === 4 && xhr.status === 200) {
                        console.log('res is', xhr.responseText)
                        // if success go login page
                        alert('create  Successful ')
                        setshowunitwater(nowdate)
                        renderpage()
                        // window.location.reload(true);
                        //  window.location.href = 'http://127.0.0.1:5500/somelogin.html';

                    } else {
                        //alert('can not create user! Pls try again.')
                    }
                };
                var data = JSON.stringify({
                    plicewater: dataUnit.plicewater, BuildingName: dataUnit.BuildingName, nowdate: nowdate
                });
                xhr.send(data);


            })
            function setshowunit(nowdate) {
                console.log('nowdate', nowdate)
                var htmlstringunit = ""
                htmlstringunit +=
                    ' <label for="exampleInputEmail1">อัพเดทล่าสุดเมื่อวันที่</label>'
                    + '                             <p id="showdatemeterbefor">' + nowdate + '</p>'
                    + '                            <label for="exampleInputEmail1">หน่วยมิเตอร์ก่อนหน้า</label>'
                    + '                              <div class="row">'
                    + '                                 <div class="col-1" id="showmeterbefor">' + _data.UnitMeter + '</div>'
                    + '                                    <div class="col-3">บาท'
                    + '                                  </div>'
                    + '                              </div>'
                document.getElementById("setshowunit").innerHTML = htmlstringunit



            }
            function setshowunitwater(nowdate) {
                console.log('nowwater', nowdate)
                var htmlstringunitwater = ""
                htmlstringunitwater +=
                    ' <label for="exampleInputEmail1">อัพเดทล่าสุดเมื่อวันที่</label>'
                    + '                             <p >' + nowdate + '</p>'
                    + '                            <label for="exampleInputEmail1">หน่วยมิเตอร์ก่อนหน้า</label>'
                    + '                              <div class="row">'
                    + '                                 <div class="col-1" >' + _data.plicewater + '</div>'
                    + '                                    <div class="col-3">บาท'
                    + '                                  </div>'
                    + '                              </div>'
                document.getElementById("setshowunitwater").innerHTML = htmlstringunitwater
            }

            //จดมิเตอร์--------------------------------------------------(ourData, Datameter, datemeter)

            function renderPostUnitMeter(Datameternow, Datameterbefor, datemeter, befordatemeter) {
                /*for (let i = 0; i < 1; i++) {
                    alert(Datameternow[i].datemeter)
                    console.log('สักที', Datameternow[i].datemeter)
                    console.log('สักที', Datameterbefor[i].datemeter)
                }
                */
                var y = 0
                var z = 0
                console.log('ปัจจุบัน', Datameternow)
                console.log('อดีต', Datameterbefor)
                var htmlStringUnitMeter = ''
                var htmlStringmetermonth = ''
                htmlStringmetermonth +=
                    ' <div class="row justify-content-center">'
                    + '      <div class="col-md-12 col-lg-8">'
                    + '         <div class="divform">'
                    + '             <form name="form2" id="form2" action="" onsubmit="" method="">'
                    + '                <div class="form-group">'
                    + '                    <label for="exampleInputPassword1">จำนวนการใช้ไฟฟ้าทั้งหมด (หน่วย)</label>'
                    + '                     <input required name="examplesomemonth" type="number" class="form-control" id="examplesomemonth"'
                    + '                     placeholder="จำนวนการใช้ไฟฟ้าทั้งหมด (หน่วย)">'
                    + '              </div>'
                    + '              <div class="form-group">'
                    + '                  <label for="exampleInputPassword1">รายจ่ายให้การไฟฟ้า (บาท)</label>'
                    + '                  <input required name="exampleunit" type="number" class="form-control" id="exampleunit"'
                    + '                      placeholder="รายจ่ายให้การไฟฟ้า (บาท)">'
                    + '              </div>'
                    + '         </form>'
                    + '       </div>'
                    + '   </div>'
                    + '    </div>'
                document.getElementById("setmetermonth").innerHTML = htmlStringmetermonth
                if (Datameternow == "" && Datameterbefor == "") {
                    // alert('ไม่มีข้อมูล')
                    htmlStringUnitMeter +=
                        '<div class="setmeter">'
                        + '<div id="clear" >'
                    for (let i = 0; i < _data.floor.length; i++) {


                        htmlStringUnitMeter +=

                            ' <div  class="row justify-content-md-center">'
                            + ' <div class="divform">'
                            + '  <div class="row justify-content-center">'
                            + '   <div class="col-2 col-sm-2"><br>'
                            + '       <p class="h4">ชั้น</p>'
                            + '   </div>'
                            + '   <div class="col-2 col-sm-2"><br>'
                            + '      <p id="Updatefloor">' + (i + 1) + '</p>'
                            + '   </div>'
                            + '  </div>'
                            //class="table-responsive table table-striped"
                            + ' <div class="table-responsive">'
                            + '   <table class="table table-bordered " >'
                            + '  <thead>'
                            + '     <tr>'
                            + '   <th scope="col" style="background-color: gray">หมายเลขห้อง</th>'
                            + '  <th scope="col" style="background-color: gray">สถานะห้อง</th>'
                            + '  <th scope="col" style="background-color: gray">เลขมิเตอร์ก่อนหน้า</th>'
                            + '  <th scope="col" style="background-color: gray">เลขมิเตอร์ปัจจุบัน</th>'
                            + '   <th scope="col" style="background-color: gray">หน่วยที่ใช้</th>'
                            + '     </tr>'
                            + '  </thead>'

                        for (let j = 0; j < _data.floor[i].room.length; j++) {

                            htmlStringUnitMeter +=

                                '<tbody > <tr><td scope="row">' + _data.floor[i].room[j].roomNumber + '</td>'
                                + ' <td id="getnum">' + _data.floor[i].room[j].roomStatus + '</th>'
                                + ' <td class="getmeterbefor" >' + y + '</th>'
                                + ' <td> <div id="education-groupboxwrapper"><div class="education-groupbox"><input    type="number" value="' + y + '"  name="UnitMeter" class="change ' + ((z++) + "-") + '" class="changemeter" style="width:85%; padding: 1px;text-align:center; margin-left: 5px;"> </div></div></th>'
                                + ' <td class="setmeterbefor"></th>'
                                + '</tbody> '
                                + '</div>'

                        }
                        htmlStringUnitMeter += '</table></div></div></div> <br>'
                    }
                    htmlStringUnitMeter += '</div>'
                    document.getElementById("divPostmeter").innerHTML = htmlStringUnitMeter
                    // tablePostUnitMeter.insertAdjacentHTML('beforeend', htmlStringUnitMeter);
                } else if (Datameternow != "" && Datameterbefor == "" || Datameternow == 'undefined' || _data.floor == 'undefined') {
                    //alert('มีข้อมูลปัจจุบัน')
                    console.log(Datameternow)
                    for (let k = 0; k < Datameternow.length; k++) {
                        console.log(Datameternow[k].datemeter)
                        htmlStringUnitMeter +=
                            '<div class="setmeter">'
                            + '<div id="clear" >'
                        for (let i = 0; i < _data.floor.length; i++) {


                            htmlStringUnitMeter +=

                                ' <div  class="row justify-content-md-center">'
                                + ' <div class="divform">'
                                + '  <div class="row justify-content-center">'
                                + '   <div class="col-2 col-sm-2"><br>'
                                + '       <p class="h4">ชั้น</p>'
                                + '   </div>'
                                + '   <div class="col-2 col-sm-2"><br>'
                                + '      <p id="Updatefloor">' + (i + 1) + '</p>'
                                + '   </div>'
                                + '  </div>'
                                //class="table-responsive table table-striped"
                                + ' <div class="table-responsive">'
                                + '   <table class="table table-bordered " >'
                                + '  <thead>'
                                + '     <tr>'
                                + '   <th scope="col" style="background-color: gray">หมายเลขห้อง</th>'
                                + '  <th scope="col" style="background-color: gray">สถานะห้อง</th>'
                                + '  <th scope="col" style="background-color: gray">เลขมิเตอร์ก่อนหน้า</th>'
                                + '  <th scope="col" style="background-color: gray">เลขมิเตอร์ปัจจุบัน</th>'
                                + '   <th scope="col" style="background-color: gray">หน่วยที่ใช้</th>'
                                + '     </tr>'
                                + '  </thead>'

                            for (let j = 0; j < _data.floor[i].room.length; j++) {

                                htmlStringUnitMeter +=

                                    '<tbody > <tr><td scope="row">' + _data.floor[i].room[j].roomNumber + '</td>'
                                    + ' <td id="getnum">' + _data.floor[i].room[j].roomStatus + '</th>'
                                    + ' <td class="getmeterbefor" >0</th>'
                                    + ' <td> <div id="education-groupboxwrapper"><div class="education-groupbox"><input   type="number" value="' + Datameternow[k].floormeter[i].roommeter[j].usemeter + '"  name="UnitMeter" class="change ' + ((z++) + "-") + '" class="changemeter" style="width:85%; padding: 1px;text-align:center; margin-left: 5px;"> </div></div></th>'
                                    + ' <td class="setmeterbefor">' + (Datameternow[k].floormeter[i].roommeter[j].usemeter) + '</th>'
                                    + '</tbody> '
                                    + '</div>'

                            }
                            htmlStringUnitMeter += '</table></div></div></div><br>'
                        }
                        htmlStringUnitMeter += '</div>'
                        document.getElementById("divPostmeter").innerHTML = htmlStringUnitMeter
                        document.getElementById("examplesomemonth").value = Datameternow[0].someunitmeter
                        document.getElementById("exampleunit").value = Datameternow[0].somepricewater

                        // tablePostUnitMeter.insertAdjacentHTML('beforeend', htmlStringUnitMeter);

                    }
                } else if (Datameternow == "" && Datameterbefor != "") {
                    //  alert('มีข้อมูลอดีต')
                    // console.log(Datameterunit[0].datameter)
                    for (let k = 0; k < Datameterbefor.length; k++) {

                        htmlStringUnitMeter +=
                            '<div class="setmeter">'
                            + '<div id="clear" >'
                        for (let i = 0; i < _data.floor.length; i++) {


                            htmlStringUnitMeter +=

                                ' <div  class="row justify-content-md-center">'
                                + ' <div class="divform">'
                                + '  <div class="row justify-content-center">'
                                + '   <div class="col-2 col-sm-2"><br>'
                                + '       <p class="h4">ชั้น</p>'
                                + '   </div>'
                                + '   <div class="col-2 col-sm-2"><br>'
                                + '      <p id="Updatefloor">' + (i + 1) + '</p>'
                                + '   </div>'
                                + '  </div>'
                                //class="table-responsive table table-striped"
                                + ' <div class="table-responsive">'
                                + '   <table class="table table-bordered " >'
                                + '  <thead>'
                                + '     <tr>'
                                + '   <th scope="col" style="background-color: gray">หมายเลขห้อง</th>'
                                + '  <th scope="col" style="background-color: gray">สถานะห้อง</th>'
                                + '  <th scope="col" style="background-color: gray">เลขมิเตอร์ก่อนหน้า</th>'
                                + '  <th scope="col" style="background-color: gray">เลขมิเตอร์ปัจจุบัน</th>'
                                + '   <th scope="col" style="background-color: gray">หน่วยที่ใช้</th>'
                                + '     </tr>'
                                + '  </thead>'

                            for (let j = 0; j < _data.floor[i].room.length; j++) {

                                htmlStringUnitMeter +=

                                    '<tbody > <tr><td scope="row">' + _data.floor[i].room[j].roomNumber + '</td>'
                                    + ' <td id="getnum">' + _data.floor[i].room[j].roomStatus + '</th>'
                                    + ' <td class="getmeterbefor" >' + (Datameterbefor[k].floormeter[i].roommeter[j].usemeter) + '</th>'
                                    + ' <td> <div id="education-groupboxwrapper"><div class="education-groupbox"><input  type="number"  value="' + y + '"  name="UnitMeter" class="change ' + ((z++) + "-" + (Datameterbefor[k].floormeter[i].roommeter[j].usemeter)) + '" class="changemeter" style="width:85%; padding: 1px;text-align:center; margin-left: 5px;"> </div></div></th>'
                                    + ' <td class="setmeterbefor"></th>'
                                    + '</tbody> '
                                    + '</div>'

                            }
                            htmlStringUnitMeter += '</table></div></div></div><br>'
                        }
                        htmlStringUnitMeter += '</div>'
                        document.getElementById("divPostmeter").innerHTML = htmlStringUnitMeter


                        // tablePostUnitMeter.insertAdjacentHTML('beforeend', htmlStringUnitMeter);

                    }
                } else if (Datameternow != "" && Datameterbefor != "") {
                    // alert('มีข้อมูลอดีตเเละปัจจุบัน')
                    // 

                    for (let k = 0; k < Datameternow.length; k++) {
                        console.log(Datameternow[k].datemeter)
                        htmlStringUnitMeter +=
                            '<div class="setmeter">'
                            + '<div id="clear" >'
                        for (let i = 0; i < _data.floor.length; i++) {


                            htmlStringUnitMeter +=

                                ' <div  class="row justify-content-md-center">'
                                + ' <div class="divform">'
                                + '  <div class="row justify-content-center">'
                                + '   <div class="col-2 col-sm-2"><br>'
                                + '       <p class="h4">ชั้น</p>'
                                + '   </div>'
                                + '   <div class="col-2 col-sm-2"><br>'
                                + '      <p id="Updatefloor">' + (i + 1) + '</p>'
                                + '   </div>'
                                + '  </div>'
                                //class="table-responsive table table-striped"
                                + ' <div class="table-responsive">'
                                + '   <table class="table table-bordered " >'
                                + '  <thead>'
                                + '     <tr>'
                                + '   <th scope="col" style="background-color: gray">หมายเลขห้อง</th>'
                                + '  <th scope="col" style="background-color: gray">สถานะห้อง</th>'
                                + '  <th scope="col" style="background-color: gray">เลขมิเตอร์ก่อนหน้า</th>'
                                + '  <th scope="col" style="background-color: gray">เลขมิเตอร์ปัจจุบัน</th>'
                                + '   <th scope="col" style="background-color: gray">หน่วยที่ใช้</th>'
                                + '     </tr>'
                                + '  </thead>'

                            for (let j = 0; j < _data.floor[i].room.length; j++) {

                                htmlStringUnitMeter +=

                                    '<tbody > <tr><td scope="row">' + _data.floor[i].room[j].roomNumber + '</td>'
                                    + ' <td id="getnum">' + _data.floor[i].room[j].roomStatus + '</th>'
                                    + ' <td class="getmeterbefor" >' + Datameterbefor[k].floormeter[i].roommeter[j].usemeter + '</th>'
                                    + ' <td> <div id="education-groupboxwrapper"><div class="education-groupbox"><input   type="number" value="' + Datameternow[k].floormeter[i].roommeter[j].usemeter + '"  name="UnitMeter" class="change ' + ((z++) + "-" + (Datameterbefor[k].floormeter[i].roommeter[j].usemeter)) + '" class="changemeter' + Datameterbefor[k].floormeter[i].roommeter[j].usemeter + '" style="width:85%; padding: 1px;text-align:center; margin-left: 5px;"> </div></div></th>'
                                    + ' <td  class="setmeterbefor">' + '' + '</td></th>'
                                    + '</tbody> '
                                    + '</div>'

                            }
                            htmlStringUnitMeter += '</table></div></div></div><br>'
                        }
                        htmlStringUnitMeter += '</div>'
                        document.getElementById("divPostmeter").innerHTML = htmlStringUnitMeter
                        document.getElementById("examplesomemonth").value = Datameternow[0].someunitmeter
                        document.getElementById("exampleunit").value = Datameternow[0].somepricewater

                        // tablePostUnitMeter.insertAdjacentHTML('beforeend', htmlStringUnitMeter);

                    }
                }
                $('.change').on('input', function (e) {
                    let count = e.target.classList[1]
                    var meternow = $(this).val();
                    let sequence = ""
                    let meterbefor = ""
                    let i = 0
                    var ans
                    while (count[i] != "-") {
                        sequence = sequence + count[i]
                        i++;
                    }
                    i++
                    while (i < count.length) {
                        meterbefor = meterbefor + count[i]
                        i++;
                    }
                    sequence = parseInt(sequence)
                    meterbefor = parseInt(meterbefor)
                    meternow = parseInt(meternow)
                    if (isNaN(meterbefor)) meterbefor = 0;

                    ans = meternow - meterbefor
                    var list = document.getElementsByClassName("setmeter")[0];
                    list.getElementsByClassName("setmeterbefor")[sequence].innerHTML = ans
                    console.log('cout', count)
                    console.log('meternow', meternow)
                    console.log('sequence', sequence)
                    console.log('meterbefor', meterbefor)


                    // alert(valuenow)


                })
            }
            //จดมิเตอรืน้ำ
            function renderwater(Datameternow, Datameterbefor, datemeter, befordatemeter) {

                var y = 0
                var z = 0
                console.log('ปัจจุบันน้ำ-', Datameternow)
                console.log('อดีตน้ำ', Datameterbefor)
                var htmlStringwater = ''
                var htmlStringwatermonth = ''
                htmlStringwatermonth +=
                    ' <div class="row justify-content-center">'
                    + '  <div class="col-md-12 col-lg-8">'
                    + '    <div class="divform">'
                    + '       <form name="form2" id="form2" action="" onsubmit="" method="">'
                    + '           <div class="form-group">'
                    + '              <label for="exampleInputPassword1">จำนวนการใช้น้ำทั้งหมด (หน่วย)</label>'
                    + '              <input required name="waterunit" type="number" class="form-control" id="waterunit"'
                    + '                 placeholder="จำนวนการใช้น้ำทั้งหมด (หน่วย)">'
                    + '         </div>'
                    + '         <div class="form-group">'
                    + '           <label for="exampleInputPassword1">รายจ่ายค่าน้ำ (บาท)</label>'
                    + '             <input required name="watermonth" type="number" class="form-control" id="watermonth"'
                    + '                  placeholder="รายจ่ายให้การประปา (บาท)">'
                    + '         </div>'
                    + '     </form>'
                    + '  </div>'
                    + ' </div>'
                    + '  </div>'
                //console.log('ggaa', htmlStringwatermonth)
                document.getElementById("setwatermonth").innerHTML = htmlStringwatermonth

                if (Datameternow == "" && Datameterbefor == "") {
                    alert('ไม่มีข้อมูล')
                    htmlStringwater +=
                        '<div class="setwater">'
                        + '<div id="clear" >'
                    for (let i = 0; i < _data.floor.length; i++) {


                        htmlStringwater +=
                            ' <div  class="row justify-content-md-center">'
                            + ' <div class="divform">'
                            + '  <div class="row justify-content-center">'
                            + '   <div class="col-2 col-sm-2"><br>'
                            + '       <p class="h4">ชั้น</p>'
                            + '   </div>'
                            + '   <div class="col-2 col-sm-2"><br>'
                            + '      <p id="Updatefloor">' + (i + 1) + '</p>'
                            + '   </div>'
                            + '  </div>'
                            //class="table-responsive table table-striped"
                            + ' <div class="table-responsive">'
                            + '   <table class="table table-bordered " >'
                            + '  <thead>'
                            + '     <tr>'
                            + '   <th scope="col" style="background-color: gray">หมายเลขห้อง</th>'
                            + '  <th scope="col" style="background-color: gray">สถานะห้อง</th>'
                            + '  <th scope="col" style="background-color: gray">เลขมิเตอร์น้ำก่อนหน้า</th>'
                            + '  <th scope="col" style="background-color: gray">เลขมิเตอร์น้ำปัจจุบัน</th>'
                            + '   <th scope="col" style="background-color: gray">หน่วยที่ใช้</th>'
                            + '     </tr>'
                            + '  </thead>'

                        for (let j = 0; j < _data.floor[i].room.length; j++) {

                            htmlStringwater +=

                                '<tbody > <tr><td scope="row">' + _data.floor[i].room[j].roomNumber + '</td>'
                                + ' <td id="getnum">' + _data.floor[i].room[j].roomStatus + '</th>'
                                + ' <td class="getwaterbefor" >' + y + '</th>'
                                + ' <td> <div id="education-groupboxwrapper"><div class="education-groupboxwater"><input  type="number" value="' + y + '"  name="UnitMeter" class="changewater ' + ((z++) + "-") + '" class="changemeter" style="width:85%; padding: 1px;text-align:center; margin-left: 5px;"> </div></div></th>'
                                + ' <td class="setwaterbefor"></th>'
                                + '</tbody> '
                                + '</div>'

                        }
                        htmlStringwater += '</table></div></div></div><br>'
                    }
                    htmlStringwater += '</div>'
                    document.getElementById("divPostwater").innerHTML = htmlStringwater
                    // tablePostUnitMeter.insertAdjacentHTML('beforeend', htmlStringUnitMeter);
                } else if (Datameternow != "" && Datameterbefor == "" || Datameternow == 'undefined' || _data.floor == 'undefined') {
                    //alert('มีข้อมูลปัจจุบัน')
                    console.log(Datameternow)
                    for (let k = 0; k < Datameternow.length; k++) {
                        console.log(Datameternow[k].datemeter)
                        htmlStringwater +=
                            '<div class="setwater">'
                            + '<div id="clear" >'
                        for (let i = 0; i < _data.floor.length; i++) {


                            htmlStringwater +=

                                ' <div  class="row justify-content-md-center">'
                                + ' <div class="divform">'
                                + '  <div class="row justify-content-center">'
                                + '   <div class="col-2 col-sm-2"><br>'
                                + '       <p class="h4">ชั้น</p>'
                                + '   </div>'
                                + '   <div class="col-2 col-sm-2"><br>'
                                + '      <p id="Updatefloor">' + (i + 1) + '</p>'
                                + '   </div>'
                                + '  </div>'
                                //class="table-responsive table table-striped"
                                + ' <div class="table-responsive">'
                                + '   <table class="table table-bordered " >'
                                + '  <thead>'
                                + '     <tr>'
                                + '   <th scope="col" style="background-color: gray">หมายเลขห้อง</th>'
                                + '  <th scope="col" style="background-color: gray">สถานะห้อง</th>'
                                + '  <th scope="col" style="background-color: gray">เลขมิเตอร์น้ำก่อนหน้า</th>'
                                + '  <th scope="col" style="background-color: gray">เลขมิเตอร์น้ำปัจจุบัน</th>'
                                + '   <th scope="col" style="background-color: gray">หน่วยที่ใช้</th>'
                                + '     </tr>'
                                + '  </thead>'

                            for (let j = 0; j < _data.floor[i].room.length; j++) {

                                htmlStringwater +=

                                    '<tbody > <tr><td scope="row">' + _data.floor[i].room[j].roomNumber + '</td>'
                                    + ' <td id="getnum">' + _data.floor[i].room[j].roomStatus + '</th>'
                                    + ' <td class="getwaterbefor" >0</th>'
                                    + ' <td> <div id="education-groupboxwrapper"><div class="education-groupboxwater"><input  type="number" value="' + Datameternow[k].floormeter[i].roommeter[j].usewater + '"  name="UnitMeter" class="changewater ' + ((z++) + "-") + '" class="changemeter" style="width:85%; padding: 1px;text-align:center; margin-left: 5px;"> </div></div></th>'
                                    + ' <td class="setwaterbefor">' + (Datameternow[k].floormeter[i].roommeter[j].usewater) + '</th>'
                                    + '</tbody> '
                                    + '</div>'

                            }
                            htmlStringwater += '</table></div></div></div><br>'
                        }
                        htmlStringwater += '</div>'
                        document.getElementById("divPostwater").innerHTML = htmlStringwater
                        document.getElementById("waterunit").value = Datameternow[0].someunitwater
                        document.getElementById("watermonth").value = Datameternow[0].somepricewater
                        // tablePostUnitMeter.insertAdjacentHTML('beforeend', htmlStringUnitMeter);

                    }
                } else if (Datameternow == "" && Datameterbefor != "") {
                    alert('มีข้อมูลอดีต')
                    // console.log(Datameterunit[0].datameter)
                    for (let k = 0; k < Datameterbefor.length; k++) {

                        htmlStringwater +=
                            '<div class="setwater">'
                            + '<div id="clear" >'
                        for (let i = 0; i < _data.floor.length; i++) {


                            htmlStringwater +=

                                ' <div  class="row justify-content-md-center">'
                                + ' <div class="divform">'
                                + '  <div class="row justify-content-center">'
                                + '   <div class="col-2 col-sm-2"><br>'
                                + '       <p class="h4">ชั้น</p>'
                                + '   </div>'
                                + '   <div class="col-2 col-sm-2"><br>'
                                + '      <p id="Updatefloor">' + (i + 1) + '</p>'
                                + '   </div>'
                                + '  </div>'
                                //class="table-responsive table table-striped"
                                + ' <div class="table-responsive">'
                                + '   <table class="table table-bordered " >'
                                + '  <thead>'
                                + '     <tr>'
                                + '   <th scope="col" style="background-color: gray">หมายเลขห้อง</th>'
                                + '  <th scope="col" style="background-color: gray">สถานะห้อง</th>'
                                + '  <th scope="col" style="background-color: gray">เลขมิเตอรน้ำ์ก่อนหน้า</th>'
                                + '  <th scope="col" style="background-color: gray">เลขมิเตอร์ปน้ำัจจุบัน</th>'
                                + '   <th scope="col" style="background-color: gray">หน่วยที่ใช้</th>'
                                + '     </tr>'
                                + '  </thead>'

                            for (let j = 0; j < _data.floor[i].room.length; j++) {

                                htmlStringwater +=

                                    '<tbody > <tr><td scope="row">' + _data.floor[i].room[j].roomNumber + '</td>'
                                    + ' <td id="getnum">' + _data.floor[i].room[j].roomStatus + '</th>'
                                    + ' <td class="getwaterbefor" >' + (Datameterbefor[k].floormeter[i].roommeter[j].usewater) + '</th>'
                                    + ' <td> <div id="education-groupboxwrapper"><div class="education-groupboxwater"><input  type="number" value="' + y + '"  name="UnitMeter" class="changewater ' + ((z++) + "-" + (Datameterbefor[k].floormeter[i].roommeter[j].usewater)) + '" class="changemeter" style="width:85%; padding: 1px;text-align:center; margin-left: 5px;"> </div></div></th>'
                                    + ' <td class="setwaterbefor"></th>'
                                    + '</tbody> '
                                    + '</div>'

                            }
                            htmlStringwater += '</table></div></div></div><br>'
                        }
                        htmlStringwater += '</div>'
                        document.getElementById("divPostwater").innerHTML = htmlStringwater

                        // tablePostUnitMeter.insertAdjacentHTML('beforeend', htmlStringUnitMeter);

                    }
                } else if (Datameternow != "" && Datameterbefor != "") {
                    // alert('มีข้อมูลอดีตเเละปัจจุบัน')
                    // 

                    for (let k = 0; k < Datameternow.length; k++) {
                        console.log(Datameternow[k].datemeter)
                        htmlStringwater +=
                            '<div class="setwater">'
                            + '<div id="clear" >'
                        for (let i = 0; i < _data.floor.length; i++) {


                            htmlStringwater +=

                                ' <div  class="row justify-content-md-center">'
                                + ' <div class="divform">'
                                + '  <div class="row justify-content-center">'
                                + '   <div class="col-2 col-sm-2"><br>'
                                + '       <p class="h4">ชั้น</p>'
                                + '   </div>'
                                + '   <div class="col-2 col-sm-2"><br>'
                                + '      <p id="Updatefloor">' + (i + 1) + '</p>'
                                + '   </div>'
                                + '  </div>'
                                //class="table-responsive table table-striped"
                                + ' <div class="table-responsive">'
                                + '   <table class="table table-bordered " >'
                                + '  <thead>'
                                + '     <tr>'
                                + '   <th scope="col" style="background-color: gray">หมายเลขห้อง</th>'
                                + '  <th scope="col" style="background-color: gray">สถานะห้อง</th>'
                                + '  <th scope="col" style="background-color: gray">เลขมิเตอร์น้ำก่อนหน้า</th>'
                                + '  <th scope="col" style="background-color: gray">เลขมิเตอร์น้ำปัจจุบัน</th>'
                                + '   <th scope="col" style="background-color: gray">หน่วยที่ใช้</th>'
                                + '     </tr>'
                                + '  </thead>'

                            for (let j = 0; j < _data.floor[i].room.length; j++) {

                                htmlStringwater +=

                                    '<tbody > <tr><td scope="row">' + _data.floor[i].room[j].roomNumber + '</td>'
                                    + ' <td id="getnum">' + _data.floor[i].room[j].roomStatus + '</th>'
                                    + ' <td class="getwaterbefor" >' + Datameterbefor[k].floormeter[i].roommeter[j].usewater + '</th>'
                                    + ' <td> <div id="education-groupboxwrapper"><div class="education-groupboxwater"><input  type="number" value="' + Datameternow[k].floormeter[i].roommeter[j].usewater + '"  name="UnitMeter" class="changewater ' + ((z++) + "-" + (Datameterbefor[k].floormeter[i].roommeter[j].usemeter)) + '" class="changemeter' + Datameterbefor[k].floormeter[i].roommeter[j].usemeter + '" style="width:85%; padding: 1px;text-align:center; margin-left: 5px;"> </div></div></th>'
                                    + ' <td  class="setwaterbefor">' + '' + '</td></th>'
                                    + '</tbody> '
                                    + '</div>'

                            }
                            htmlStringwater += '</table></div></div></div><br>'
                        }
                        htmlStringwater += '</div>'
                        document.getElementById("divPostwater").innerHTML = htmlStringwater
                        document.getElementById("waterunit").value = Datameternow[0].someunitwater
                        document.getElementById("watermonth").value = Datameternow[0].somepricewater
                        // tablePostUnitMeter.insertAdjacentHTML('beforeend', htmlStringUnitMeter);

                    }


                }
                $('.changewater').on('input', function (e) {
                    let count = e.target.classList[1]
                    var waternow = $(this).val();
                    let sequence = ""
                    let meterbefor = ""
                    let i = 0
                    var ans
                    while (count[i] != "-") {
                        sequence = sequence + count[i]
                        i++;
                    }
                    i++
                    while (i < count.length) {
                        meterbefor = meterbefor + count[i]
                        i++;
                    }
                    sequence = parseInt(sequence)
                    meterbefor = parseInt(meterbefor)
                    waternow = parseInt(waternow)
                    if (isNaN(meterbefor)) meterbefor = 0;

                    ans = waternow - meterbefor
                    console.log('gg', ans)
                    var list = document.getElementsByClassName("setwater")[0];
                    list.getElementsByClassName("setwaterbefor")[sequence].innerHTML = ans
                    console.log('cout', count)
                    console.log('waternow', waternow)
                    console.log('sequence', sequence)
                    console.log('meterbefor', meterbefor)

                    // alert(valuenow)
                })
            }
            $('#formUpdateUnitMeter').submit(function () {
                let Rentroommeter = []
                for (let i = 0; i < _data.floor.length; i++) {
                    for (let j = 0; j < _data.floor[i].room.length; j++) {
                        Rentroommeter.push(_data.floor[i].room[j].rentroom)
                        //    console.log('=================')
                        //    console.log(_data.floor[i].room[j].rentroom)
                    }
                }

                //เลขมิเตอร์ที่กรอก
                /*console.log('=================')
                console.log(Rentroommeter)
                console.log(_data)
                console.log('=================')
                */
                var eduarray = [];
                $('.education-groupbox').each(function (index, el) {
                    var _this = $(this);
                    eduarray[index] = [];
                    _this.find('input').each(function (key, v) {
                        eduarray[index].push(v.value);
                    });

                });
                console.log('เลขมิเตอร์ที่กรอก  -->' + eduarray);
                //หน่วยที่ใช้ในเดือนนั้น
                var metermonthuse = [];
                var meterst = []
                var id = document.getElementsByClassName("setmeterbefor");
                for (var i = 0; i < id.length; i++) {
                    metermonthuse[i] = parseInt(id[i].innerHTML)
                }
                console.log('จำนวนมิเตอร์ที่ใช้ในเดือนนั้น', metermonthuse)

                //มิเตอร์ที่ใช้ก่อนห้า
                var metermonthusebefor = [];
                var meterbefor = []
                var idmeter = document.getElementsByClassName("getmeterbefor");
                for (var i = 0; i < idmeter.length; i++) {
                    metermonthusebefor[i] = parseInt(idmeter[i].innerHTML)
                }
                console.log('เลขมิเตอร์ที่ใช้ก่อนหน้า', metermonthusebefor)

                for (let i = 0; i < metermonthuse.length; i++) {
                    if (isNaN(metermonthuse[i])) metermonthuse[i] = 0;
                    if (isNaN(metermonthusebefor[i])) metermonthusebefor[i] = 0;

                }

                for (let i = 0; i < metermonthuse.length; i++) {

                    if (metermonthuse[i] != 0) {
                        meterst[i] = "ค้างชำระ"
                        console.log('ค้างชำระ', metermonthuse[i])
                    } else {
                        meterst[i] = "ไม่มียอดค้างชำระ"
                        console.log('ไม่ค้างชำระ', metermonthuse[i])
                    }
                }


                console.log('eduarray[0] -->' + eduarray[0]);
                console.log('eduarray[1] -->' + eduarray[1]);
                console.log('eduarray    -->' + eduarray);
                console.log('metermonthuse[0] -->' + metermonthuse[0]);
                console.log('metermonthuse[1] -->' + metermonthuse[1]);
                console.log('metermonthuse   -->' + metermonthuse);
                //ดึงค่าในหน้า ค่าไฟฟ้ารวมของมิเตอร์รวมของหอพัก

                let floormeter = []

                for (let i = 0; i < _data.floor.length; i++) {
                    let f = _data.floor[i].room.length
                    floormeter.push(f)
                }
                let k = 0
                let myData = {}
                myData.pricemeter = _data.UnitMeter
                myData.pricewater = _data.plicewater
                myData.buildingnamemeter = _data.BuildingName
                myData.datemeter = datemeter
                //  myData.allunitmeter = ''
                //  myData.buymeter = ''

                let floorArray = []
                for (let i = 0; i < _data.floor.length; i++) {
                    let floorData = {}
                    let roomArrayPerFloor = []

                    for (let j = 0; j < floormeter[i]; j++) {
                        let roomNumbermeter = ''
                        if ((i + 1) <= 9) {
                            roomNumbermeter = '0' + (i + 1)
                        } else {
                            roomNumbermeter = '' + (i + 1)
                        }
                        if ((j + 1) <= 9) {
                            roomNumbermeter += ('0' + (j + 1))
                        } else {
                            roomNumbermeter += (j + 1)
                        }
                        let beforusemeter = parseInt(metermonthusebefor[k])
                        let usemeter = parseInt(eduarray[k])
                        let rentroommeter = parseInt(Rentroommeter[k])
                        let usemetermonth = parseInt(metermonthuse[k])
                        let meterstatus = "" + meterst[k]
                        let dateroommeter = datemeter + "," + roomNumbermeter
                        k++
                        let roomData = {
                            beforusemeter,
                            roomNumbermeter,
                            usemeter,
                            usemetermonth,
                            meterstatus,
                            dateroommeter,
                            rentroommeter
                        }

                        roomArrayPerFloor.push(roomData)

                    }
                    floorData.roommeter = roomArrayPerFloor
                    floorData.Number = '' + (i + 1)
                    floorArray.push(floorData)

                }
                myData.floormeter = floorArray

                console.log('Data is', myData)
                postData(myData);
                return false;

            });

            function postData(myData) {
                var url = "https://electricitymeter.herokuapp.com/postMeter";
                var xhr = new XMLHttpRequest();
                xhr.open("POST", url, true);
                xhr.setRequestHeader("Content-Type", "application/json");
                xhr.onreadystatechange = function () {
                    if (xhr.readyState === 4 && xhr.status === 200) {
                        console.log('res is', xhr.responseText)
                        // if success go login page
                        alert('บันทึกสำเร็จ')
                        getmeterbuilds()
                        //   window.location.reload(true);

                    } else {
                        //alert('can not create user! Pls try again.')
                    }
                };
                var data = JSON.stringify({ floormeter: myData.floormeter, pricemeter: myData.pricemeter, pricewater: myData.pricewater, buildingnamemeter: myData.buildingnamemeter, datemeter: myData.datemeter, });
                xhr.send(data);
            }
            $('#formUpdateUnitMeterSome').submit(function () {
                if (document.getElementById('exampleunit').value == "") {
                    alert('Please Input unit meter');
                    return false;
                } else if (document.getElementById('examplesomemonth').value == "") {
                    alert('Please Input amount ');
                    return false;
                }
                var someunitmeter = document.getElementById("examplesomemonth").value
                var somepricemeter = document.getElementById("exampleunit").value

                console.log('จำนวนำไฟ', someunitmeter)
                console.log('จ่ายไฟ', somepricemeter)

                pricemeter = _data.UnitMeter
                pricewater = _data.plicewater
                buildingnamemeter = _data.BuildingName
                datemeter = datemeter
                somepricemeter = somepricemeter
                someunitmeter = someunitmeter

                var url = "https://electricitymeter.herokuapp.com/postsomeMeter";
                var xhr = new XMLHttpRequest();
                xhr.open("POST", url, true);
                xhr.setRequestHeader("Content-Type", "application/json");
                xhr.onreadystatechange = function () {
                    if (xhr.readyState === 4 && xhr.status === 200) {
                        console.log('res is', xhr.responseText)
                        // if success go login page
                        alert('บันทึกสำเร็จ')
                        getmeterbuilds()
                        //   window.location.reload(true);

                    } else {
                        //alert('can not create user! Pls try again.')
                    }
                };
                var data = JSON.stringify({ somepricemeter: somepricemeter, someunitmeter: someunitmeter, buildingnamemeter: buildingnamemeter, datemeter: datemeter, pricemeter: pricemeter, pricewater: pricewater });
                xhr.send(data);
                return false;

            });
            $('#formUpdateUnitWaters').submit(function () {
                let Rentroommeter = []
                for (let i = 0; i < _data.floor.length; i++) {
                    for (let j = 0; j < _data.floor[i].room.length; j++) {
                        Rentroommeter.push(_data.floor[i].room[j].rentroom)
                        //    console.log('=================')
                        //    console.log(_data.floor[i].room[j].rentroom)
                    }
                }
                //มิเตอร์น้ำเดือนนั้นที่กรอก
                var eduarraywater = [];
                $('.education-groupboxwater').each(function (index, el) {
                    var _this = $(this);
                    eduarraywater[index] = [];
                    _this.find('input').each(function (key, v) {
                        eduarraywater[index].push(v.value);
                    });
                });
                console.log('มิเตอร์น้ำที่กรอก   -->' + eduarraywater);
                //หน่วยน้ำที่ใช้ในเดือนนั้น
                var watermonthuse = [];
                var waterst = []
                var idwa = document.getElementsByClassName("setwaterbefor");
                for (var i = 0; i < idwa.length; i++) {
                    watermonthuse[i] = parseInt(idwa[i].innerHTML)
                }
                console.log('หน่วมิเตอร์น้ำที่ใช้ในเดือนนั้น', watermonthuse)
                //มิเตอร์น้ำที่ใช้ก่อนหน้า
                var watermonthusebefor = [];
                var waterbefor = []
                var idwater = document.getElementsByClassName("getwaterbefor");
                for (var i = 0; i < idwa.length; i++) {
                    watermonthusebefor[i] = parseInt(idwater[i].innerHTML)
                }
                console.log('เลขมิเตอร์น้ำก่อนหน้า', watermonthusebefor)
                for (let i = 0; i < watermonthuse.length; i++) {
                    if (isNaN(watermonthuse[i])) watermonthuse[i] = 0;
                    if (isNaN(watermonthusebefor[i])) watermonthusebefor[i] = 0;
                }

                for (let i = 0; i < watermonthuse.length; i++) {
                    if (watermonthuse[i] != 0) {
                        waterst[i] = "ค้างชำระ"
                        console.log('ค้างชำระ', watermonthuse[i])
                    } else {
                        waterst[i] = "ไม่มียอดค้างชำระ"
                        console.log('ไม่ค้างชำระ', watermonthuse[i])
                    }
                }

                //ดึงค่าในหน้า ค่าไฟฟ้ารวมของมิเตอร์รวมของหอพัก
                let floormeter = []
                for (let i = 0; i < _data.floor.length; i++) {
                    let f = _data.floor[i].room.length
                    floormeter.push(f)
                }
                let k = 0
                let myData = {}
                myData.pricemeter = _data.UnitMeter
                myData.pricewater = _data.plicewater
                myData.buildingnamemeter = _data.BuildingName
                myData.datemeter = datemeter

                //  myData.allunitmeter = ''
                //  myData.buymeter = ''
                let floorArray = []
                for (let i = 0; i < _data.floor.length; i++) {
                    let floorData = {}
                    let roomArrayPerFloor = []
                    for (let j = 0; j < floormeter[i]; j++) {
                        let roomNumbermeter = ''
                        if ((i + 1) <= 9) {
                            roomNumbermeter = '0' + (i + 1)
                        } else {
                            roomNumbermeter = '' + (i + 1)
                        }
                        if ((j + 1) <= 9) {
                            roomNumbermeter += ('0' + (j + 1))
                        } else {
                            roomNumbermeter += (j + 1)
                        }
                        let rentroommeter = parseInt(Rentroommeter[k])
                        let beforusewater = parseInt(watermonthusebefor[k])
                        let usewater = parseInt(eduarraywater[k])
                        let usewatermonth = parseInt(watermonthuse[k])
                        let waterstatus = "" + waterst[k]
                        let dateroommeter = datemeter + "," + roomNumbermeter
                        k++
                        let roomData = {

                            roomNumbermeter,
                            beforusewater,
                            usewater,
                            usewatermonth,
                            waterstatus,
                            dateroommeter,
                            rentroommeter
                        }
                        roomArrayPerFloor.push(roomData)
                    }
                    floorData.roommeter = roomArrayPerFloor
                    floorData.Number = '' + (i + 1)
                    floorArray.push(floorData)
                }
                myData.floormeter = floorArray
                console.log('Data is', myData)
                postDatawater(myData);
                return false;

            });
            function postDatawater(myData) {
                var url = "https://electricitymeter.herokuapp.com/postWater";
                var xhr = new XMLHttpRequest();
                xhr.open("POST", url, true);
                xhr.setRequestHeader("Content-Type", "application/json");
                xhr.onreadystatechange = function () {
                    if (xhr.readyState === 4 && xhr.status === 200) {
                        console.log('res is', xhr.responseText)
                        // if success go login page
                        alert('บันทึกสำเร็จ')
                        getmeterbuilds()
                        //   window.location.reload(true);
                    } else {
                        //alert('can not create user! Pls try again.')
                    }
                };
                var data = JSON.stringify({ floormeter: myData.floormeter, pricemeter: myData.pricemeter, pricewater: myData.pricewater, buildingnamemeter: myData.buildingnamemeter, datemeter: myData.datemeter, });
                xhr.send(data);
            }
            $('#formUpdateUnitSomeWater').submit(function () {

                if (document.getElementById('waterunit').value == "") {
                    alert('Please Input unit water');
                    return false;
                } else if (document.getElementById('watermonth').value == "") {
                    alert('Please Input amount ');
                    return false;
                }
                var someunitwater = document.getElementById("waterunit").value
                var somepricewater = document.getElementById("watermonth").value

                console.log('จำนวนน้ำ', someunitwater)
                console.log('จ่ายน้ำ', somepricewater)

                pricemeter = _data.UnitMeter
                pricewater = _data.plicewater
                buildingnamemeter = _data.BuildingName
                datemeter = datemeter
                somepricewater = somepricewater
                someunitwater = someunitwater

                var url = "https://electricitymeter.herokuapp.com/postsomeWater";
                var xhr = new XMLHttpRequest();
                xhr.open("POST", url, true);
                xhr.setRequestHeader("Content-Type", "application/json");
                xhr.onreadystatechange = function () {
                    if (xhr.readyState === 4 && xhr.status === 200) {
                        console.log('res is', xhr.responseText)
                        // if success go login page
                        alert('บันทึกสำเร็จ')
                        getmeterbuilds()

                        //   window.location.reload(true);

                    } else {
                        //alert('can not create user! Pls try again.')
                    }
                };
                var data = JSON.stringify({ somepricewater: somepricewater, someunitwater: someunitwater, buildingnamemeter: buildingnamemeter, datemeter: datemeter, pricemeter: pricemeter, pricewater: pricewater });
                xhr.send(data);
                return false;

            });


            //บันทึกมิเตอร์รวมของหอพัก


            //วิเคราห์หอพัก-----------------------------------------------
            $('#analysis').on('input', function (e) {

                //     $("#tablePostUnitMeter").remove();
                var currentVal = document.getElementById("analysis").value;
                alert(currentVal)
                document.getElementById("ShowMonthAnalysis").innerHTML = ''
                document.getElementById("ShowYearAnalysis").innerHTML = currentVal
                // console.log('ปัจจุบัน',currentVal)
                datemeter = "" + currentVal
                // console.log('ปัจจุบันสตริง', datemeter)

                let i = 0
                while (datemeter[i] != "-") {
                    beforyear = beforyear + datemeter[i]
                    i++;
                }
                i++
                while (i < datemeter.length) {
                    beformont = beformont + datemeter[i]
                    i++;
                }

                var getdata = []
                getdata.push(BuildingName)
                getdata.push(datemeter)
                // getdata.push(befordatemeter)
                console.log('data2ก่อนส่ง', getdata)
                var Request = new XMLHttpRequest();
                Request.open('GET', 'https://electricitymeter.herokuapp.com/getmeteranalysis/' + getdata)
                Request.onload = function () {
                    var Dataanalysis = JSON.parse(Request.responseText);
                    console.log('meteranalysis', Dataanalysis)

                    renderAnalysis(Dataanalysis)
                    renderAnalysiswater(Dataanalysis)
                    renderoverloadmeter(Dataanalysis)
                    renderoverloadwater(Dataanalysis)
                }
                Request.send();

                //  getDataMeter(getdata, datemeter, befordatemeter)

            })
            function renderAnalysis(Dataanalysis) {
                document.getElementById("container").innerHTML = ""
                // Profit กำไร ขาดทุน
                // var unitcentral unitส่วนกลาง
                // var countUnitAnalysis = 0 ผู้ใช้กี่หน่วยทั้งหอ
                // var countsomepricemeter จ่ายให้การไฟฟ้า
                // var countsomeunitmeter หน่วยที่จ่ายให้การไฟฟ้า
                // var priceunit ราคาต่ออหน่วยที่เก็บ 
                //income รายรับจากหอพัก
                if (Dataanalysis == "") {
                    alert('กรุณาบันทึกข้อมูลหน่วยมิเตอร์ของหอพัก')
                    return false;
                }
                if (Dataanalysis[0].somepricemeter == "" || Dataanalysis[0].someunitmeter == "" || Dataanalysis[0].somepricemeter == undefined || Dataanalysis[0].someunitmeter == undefined) {
                    alert('กรุณาบันทึกข้อมูลหน่วยมิเตอร์ไฟฟ้ารวมของหอพัก เเละรายจ่ายค่าไฟฟ้าให้เรียบร้อย ไม่อย่างนั้นข้อมูลจะไม่สมบูรณ์')
                    return false;
                }
                console.log('ราคามิเตอร์', Dataanalysis[0].somepricemeter)
                var htmlstringchart = ""
                var htmlstringchart2 = ""
                var Profit = 0
                var unitcentral = 0
                var income = 0
                var countUnitAnalysis = 0
                var countsomepricemeter = Dataanalysis[0].somepricemeter
                var countsomeunitmeter = Dataanalysis[0].someunitmeter
                var priceunit = Dataanalysis[0].pricemeter


                for (let i = 0; i < Dataanalysis[0].floormeter.length; i++) {
                    for (let j = 0; j < Dataanalysis[0].floormeter[i].roommeter.length; j++) {
                        if (Dataanalysis[0].floormeter[i].roommeter[j].meterstatus == "ค้างชำระ") {
                            countUnitAnalysis = countUnitAnalysis + Dataanalysis[0].floormeter[i].roommeter[j].usemetermonth
                        }
                    }
                }
                if (countUnitAnalysis <= 0) {
                    return false;
                }
                //---------water--------------



                income = countUnitAnalysis * priceunit
                unitcentral = countsomeunitmeter - countUnitAnalysis
                Profit = income - countsomepricemeter

                console.log('การใช้ไฟฟ้าของผู้เช่า (หน่วย) ', countUnitAnalysis)
                console.log('การใช้ไฟฟ้าของส่วนกลาง(หน่วย) ', unitcentral)
                console.log('การใช้ไฟฟ้าทั้งหมด(หน่วย) ', countsomeunitmeter)
                console.log('รายรับค่าไฟฟ้าจากผู้เช่า(บาท) ', income)
                console.log('รายจ่ายการไฟฟ้า(บาท) ', countsomeunitmeter)
                console.log('กำไร/ขาดทุน ค่าไฟฟ้า(บาท) ', Profit)
                console.log('----------------------------------------')


                google.charts.load('current', { 'packages': ['corechart'] });
                google.charts.setOnLoadCallback(drawChart);
                function drawChart() {
                    var data = google.visualization.arrayToDataTable([
                        ['Task', ' per Month'],
                        ['การใช้ไฟฟ้าของผู้เช่า (หน่วย)', countUnitAnalysis],
                        ['การใช้ไฟฟ้าของส่วนกลาง(หน่วย)', unitcentral],


                    ]);

                    // Optional; add a title and set the width and height of the chart
                    var options = { 'title': 'การใช้พลังงานของทั้งหอพัก ' + countsomeunitmeter + ' หน่วย', 'height': 400, 'width': 390, responsive: true };

                    // Display the chart inside the <div> element with id="piechart"
                    var chart = new google.visualization.PieChart(document.getElementById('piechart'));
                    chart.draw(data, options);
                    htmlstringchart += ''
                        + '<div class="row">'
                        + '       <div class="col-5">'
                        + '          <p class="h5">การใช้ไฟฟ้าของทั้งหอพัก</p>'
                        + '       </div>'
                        + '     <div class="col-2">'
                        + '         <p>' + countsomeunitmeter + '</p>'
                        + '      </div>'
                        + '      <div class="col-1">'
                        + '         <p>หน่วย</p>'
                        + '      </div>'
                        + '    </div>'
                        + '    <div class="row">'
                        + '       <div class="col-5">'
                        + '          <p class="h5">การใช้ไฟฟ้าของผู้เช่า</p>'
                        + '       </div>'
                        + '     <div class="col-2">'
                        + '         <p>' + countUnitAnalysis + '</p>'
                        + '      </div>'
                        + '      <div class="col-1">'
                        + '         <p>หน่วย</p>'
                        + '      </div>'
                        + '    </div>'
                        + '    <div class="row">'
                        + '        <div class="col-5">'
                        + '          <p class="h5">การใช้ไฟฟ้าของส่วนกลาง</p>'
                        + '        </div>'
                        + '       <div class="col-2">'
                        + '           <p>' + unitcentral + '</p>'
                        + '        </div>'
                        + '         <div class="col-1">'
                        + '            <p>หน่วย</p>'
                        + '          </div>'
                        + '       </div>'
                    document.getElementById("setchart").innerHTML = htmlstringchart
                }
                anychart.onDocumentReady(function () {

                    // set the data
                    var data = {
                        header: ["Name", "Death toll"],
                        rows: [
                            ["รายรับค่าไฟฟ้าจากผู้เช่า(บาท)", income],
                            ["รายจ่ายการไฟฟ้า(บาท)", countsomepricemeter],
                            ["กำไร/ขาดทุน ค่าไฟฟ้า(บาท)", Profit],

                        ]
                    };

                    // create the chart
                    var chart = anychart.column();

                    // add data
                    chart.data(data);

                    // set the chart title
                    chart.title("รายรับ-รายจ่ายของหอพัก");

                    // draw
                    chart.container("container");
                    chart.draw();
                    htmlstringchart2 += ''
                        + '<div class="row">'
                        + '       <div class="col-5">'
                        + '          <p class="h5">รายรับค่าไฟฟ้าจากผู้เช่า</p>'
                        + '       </div>'
                        + '     <div class="col-2">'
                        + '         <p>' + income + '</p>'
                        + '      </div>'
                        + '      <div class="col-1">'
                        + '         <p>บาท</p>'
                        + '      </div>'
                        + '    </div>'
                        + '    <div class="row">'
                        + '       <div class="col-5">'
                        + '          <p class="h5">รายจ่ายการไฟฟ้า(บาท)</p>'
                        + '       </div>'
                        + '     <div class="col-2">'
                        + '         <p>' + countsomepricemeter + '</p>'
                        + '      </div>'
                        + '      <div class="col-1">'
                        + '         <p>บาท</p>'
                        + '      </div>'
                        + '    </div>'
                        + '    <div class="row">'
                        + '        <div class="col-5">'
                        + '          <p class="h5">กำไร/ขาดทุน ค่าไฟฟ้า</p>'
                        + '        </div>'
                        + '       <div class="col-2">'
                        + '           <p>' + Profit + '</p>'
                        + '        </div>'
                        + '         <div class="col-1">'
                        + '            <p>บาท</p>'
                        + '          </div>'
                        + '       </div>'
                    document.getElementById("setchart2").innerHTML = htmlstringchart2
                });


            }
            function renderAnalysiswater(Dataanalysis) {
                document.getElementById("containerwater").innerHTML = ""
                if (Dataanalysis == "") {
                    alert('กรุณาบันทึกข้อมูลหน่วยมิเตอร์ของหอพัก')
                    return false;
                }
                if (Dataanalysis[0].somepricewater == "" || Dataanalysis[0].someunitwater == "" || Dataanalysis[0].somepricewater == undefined || Dataanalysis[0].someunitwater == undefined) {
                    alert('กรุณาบันทึกข้อมูลหน่วยมิเตอร์น้ำรวมของหอพักเเละรายจ่ายค่าน้ำให้การประปาให้เรียบร้อย ไม่อย่างนั้นข้อมูลจะไม่สมบูรณ์')
                    return false;
                }

                //-----------------------สร้างตัวเเปลวิเคราะห์การใช้งานพลังงานน้ำ--------------------------
                var count = 0
                var htmlstringchartwater = ""
                var htmlstringchartwater2 = ""
                var Profitwater = 0
                var unitcentralwater = 0
                var incomewater = 0
                var countUnitAnalysiswater = 0
                var countsomepricewater = Dataanalysis[0].somepricewater
                var countsomeunitwater = Dataanalysis[0].someunitwater
                var priceunitwater = Dataanalysis[0].pricewater

                if (_data.methodwater == "rentunit") {


                    for (let i = 0; i < Dataanalysis[0].floormeter.length; i++) {
                        for (let j = 0; j < Dataanalysis[0].floormeter[i].roommeter.length; j++) {
                            if (Dataanalysis[0].floormeter[i].roommeter[j].waterstatus == "ค้างชำระ") {
                                countUnitAnalysiswater = countUnitAnalysiswater + Dataanalysis[0].floormeter[i].roommeter[j].usewatermonth
                            }
                        }
                    }
                    if (countUnitAnalysiswater <= 0) {
                        return false;
                    }
                    incomewater = countUnitAnalysiswater * priceunitwater
                    unitcentralwater = countsomeunitwater - countUnitAnalysiswater
                    Profitwater = incomewater - countsomepricewater

                    console.log('ค่าน้ำ', priceunitwater)
                    console.log('ค่าน้ำ', countUnitAnalysiswater)
                    console.log('ค่าน้ำ', incomewater)
                    console.log('การใช้น้ำของผู้เช่า (หน่วย) ', countUnitAnalysiswater)
                    console.log('การใช้น้ำของส่วนกลาง(หน่วย) ', unitcentralwater)
                    console.log('การใช้น้ำทั้งหมด(หน่วย) ', countsomeunitwater)
                    console.log('รายรับค่าน้ำจากผู้เช่า(บาท) ', incomewater)
                    console.log('รายจ่ายการน้ำ(บาท) ', countsomeunitwater)
                    console.log('กำไร/ขาดทุน ค่าน้ำ(บาท) ', Profitwater)
                } else {
                    console.log('ทำวิเคาร์รายเดือน')
                    for (let i = 0; i < Dataanalysis[0].floormeter.length; i++) {
                        for (let j = 0; j < Dataanalysis[0].floormeter[i].roommeter.length; j++) {
                            if (Dataanalysis[0].floormeter[i].roommeter[j].waterstatus == "ค้างชำระ") {
                                countUnitAnalysiswater = countUnitAnalysiswater + Dataanalysis[0].floormeter[i].roommeter[j].usewatermonth
                                count++
                            }
                        }
                    }
                    if (countUnitAnalysiswater <= 0) {
                        return false;
                    }

                    incomewater = (count * priceunitwater)
                    unitcentralwater = countsomeunitwater - countUnitAnalysiswater
                    Profitwater = incomewater - countsomepricewater

                    console.log('ค่าน้ำ', count)
                    console.log('ค่าน้ำ', priceunitwater)
                    console.log('ค่าน้ำ', countUnitAnalysiswater)
                    console.log('ค่าน้ำ', incomewater)
                    console.log('การใช้น้ำของผู้เช่า (หน่วย) ', countUnitAnalysiswater)
                    console.log('การใช้น้ำของส่วนกลาง(หน่วย) ', unitcentralwater)
                    console.log('การใช้น้ำทั้งหมด(หน่วย) ', countsomeunitwater)
                    console.log('รายรับค่าน้ำจากผู้เช่า(บาท) ', incomewater)
                    console.log('รายจ่ายการน้ำ(บาท) ', countsomeunitwater)
                    console.log('กำไร/ขาดทุน ค่าน้ำ(บาท) ', Profitwater)
                }

                google.charts.load('current', { 'packages': ['corechart'] });
                google.charts.setOnLoadCallback(drawChart);
                function drawChart() {
                    var data = google.visualization.arrayToDataTable([
                        ['Task', ' per Month'],
                        ['การใช้น้ำของผู้เช่า (หน่วย)', countUnitAnalysiswater],
                        ['การใช้น้ำของส่วนกลาง(หน่วย)', unitcentralwater],


                    ]);

                    // Optional; add a title and set the width and height of the chart
                    var options = { 'title': 'การใช้พลังงานน้ำของทั้งหอพัก ' + countsomeunitwater + ' หน่วย', 'height': 400, 'width': 390, responsive: true };

                    // Display the chart inside the <div> element with id="piechart"
                    var chart = new google.visualization.PieChart(document.getElementById('piechartwater'));
                    chart.draw(data, options);
                    htmlstringchartwater += ''
                        + '<div class="row">'
                        + '       <div class="col-5">'
                        + '          <p class="h5">การใช้น้ำของทั้งหอพัก</p>'
                        + '       </div>'
                        + '     <div class="col-2">'
                        + '         <p>' + countsomeunitwater + '</p>'
                        + '      </div>'
                        + '      <div class="col-1">'
                        + '         <p>หน่วย</p>'
                        + '      </div>'
                        + '    </div>'
                        + '    <div class="row">'
                        + '       <div class="col-5">'
                        + '          <p class="h5">การใช้น้ำของผู้เช่า</p>'
                        + '       </div>'
                        + '     <div class="col-2">'
                        + '         <p>' + countUnitAnalysiswater + '</p>'
                        + '      </div>'
                        + '      <div class="col-1">'
                        + '         <p>หน่วย</p>'
                        + '      </div>'
                        + '    </div>'
                        + '    <div class="row">'
                        + '        <div class="col-5">'
                        + '          <p class="h5">การใช้น้ำของส่วนกลาง</p>'
                        + '        </div>'
                        + '       <div class="col-2">'
                        + '           <p>' + unitcentralwater + '</p>'
                        + '        </div>'
                        + '         <div class="col-1">'
                        + '            <p>หน่วย</p>'
                        + '          </div>'
                        + '       </div>'
                    document.getElementById("setchartwater").innerHTML = htmlstringchartwater
                }
                anychart.onDocumentReady(function () {

                    // set the data
                    var data = {
                        header: ["Name", "Death toll"],
                        rows: [
                            ["รายรับค่าน้ำจากผู้เช่า(บาท)", incomewater],
                            ["รายจ่ายการน้ำ(บาท)", countsomepricewater],
                            ["กำไร/ขาดทุน ค่าน้ำ(บาท)", Profitwater],

                        ]
                    };

                    // create the chart
                    var chart = anychart.column();

                    // add data
                    chart.data(data);

                    // set the chart title
                    chart.title("รายรับ-รายจ่ายค่าน้ำของหอพัก");

                    // draw
                    chart.container("containerwater");
                    chart.draw();
                    htmlstringchartwater2 += ''
                        + '<div class="row">'
                        + '       <div class="col-5">'
                        + '          <p class="h5">รายรับค่าน้ำจากผู้เช่า</p>'
                        + '       </div>'
                        + '     <div class="col-2">'
                        + '         <p>' + incomewater + '</p>'
                        + '      </div>'
                        + '      <div class="col-1">'
                        + '         <p>บาท</p>'
                        + '      </div>'
                        + '    </div>'
                        + '    <div class="row">'
                        + '       <div class="col-5">'
                        + '          <p class="h5">รายจ่ายการประปา(บาท)</p>'
                        + '       </div>'
                        + '     <div class="col-2">'
                        + '         <p>' + countsomepricewater + '</p>'
                        + '      </div>'
                        + '      <div class="col-1">'
                        + '         <p>บาท</p>'
                        + '      </div>'
                        + '    </div>'
                        + '    <div class="row">'
                        + '        <div class="col-5">'
                        + '          <p class="h5">กำไร/ขาดทุน ค่าน้ำ</p>'
                        + '        </div>'
                        + '       <div class="col-2">'
                        + '           <p>' + Profitwater + '</p>'
                        + '        </div>'
                        + '         <div class="col-1">'
                        + '            <p>บาท</p>'
                        + '          </div>'
                        + '       </div>'
                    document.getElementById("setchartwater2").innerHTML = htmlstringchartwater2
                });


            }
            function renderoverloadmeter(Dataanalysis) {
                var count = 0
                var htmlsringovermeter = ''
                htmlsringovermeter += ''
                    + ' <table border = "2" width = "100%" class=" table table-striped" >'
                    + '         <thead>'
                    + '            <tr>'
                    + '               <th scope="col-3" style="background-color: gray">หมายเลขห้อง</th>'
                    + '              <th scope="col-3" style="background-color: gray">จำนวนหน่วยที่ใช้</th>'
                    + '           </tr>'
                    + '        </thead>'
                    + '         <tbody>'
                for (let i = 0; i < Dataanalysis[0].floormeter.length; i++) {
                    for (let j = 0; j < Dataanalysis[0].floormeter[i].roommeter.length; j++) {
                        if (Dataanalysis[0].floormeter[i].roommeter[j].meterstatus == "ค้างชำระ" && _data.floor[i].room[j].roomStatus == "ว่าง") {
                            count = count + Dataanalysis[0].floormeter[i].roommeter[j].usemetermonth

                            htmlsringovermeter += ''
                                + ' <tr>'
                                + '    <td scope="row"> ' + Dataanalysis[0].floormeter[i].roommeter[j].roomNumbermeter + '</td>'
                                + '     <td scope="row"> ' + Dataanalysis[0].floormeter[i].roommeter[j].usemetermonth + '</td>'
                            htmlsringovermeter += '</tr>'
                        }
                    }
                }
                htmlsringovermeter += ''
                    + '  </tbody >'
                htmlsringovermeter += '  </table >'
                    + '<div class="row">'
                    + '       <div class="col-5">'
                    + '          <p class="h5">รวมทั้งสิ้น</p>'
                    + '       </div>'
                    + '     <div class="col-2">'
                    + '         <p>' + count + '</p>'
                    + '      </div>'
                    + '      <div class="col-1">'
                    + '         <p>หน่วย</p>'
                    + '      </div>'
                    + '    </div>'
                    + '<div class="row">'
                    + '       <div class="col-5">'
                    + '          <p class="h5">คิดเป็นเงิน</p>'
                    + '       </div>'
                    + '     <div class="col-2">'
                    + '         <p>' + (count * Dataanalysis[0].pricemeter) + '</p>'
                    + '      </div>'
                    + '      <div class="col-1">'
                    + '         <p>บาท</p>'
                    + '      </div>'
                    + '    </div>'
                document.getElementById("overmeter").innerHTML = htmlsringovermeter
            }
            function renderoverloadwater(Dataanalysis) {
                var count = 0
                var htmlsringoverwater = ''
                htmlsringoverwater += ''
                    + ' <table border = "2" width = "100%" class=" table table-striped" >'
                    + '         <thead>'
                    + '            <tr>'
                    + '               <th scope="col-3" style="background-color: gray">หมายเลขห้อง</th>'
                    + '              <th scope="col-3" style="background-color: gray">จำนวนหน่วยที่ใช้</th>'
                    + '           </tr>'
                    + '        </thead>'
                    + '         <tbody>'
                for (let i = 0; i < Dataanalysis[0].floormeter.length; i++) {
                    for (let j = 0; j < Dataanalysis[0].floormeter[i].roommeter.length; j++) {
                        if (Dataanalysis[0].floormeter[i].roommeter[j].waterstatus == "ค้างชำระ" && _data.floor[i].room[j].roomStatus == "ว่าง") {
                            count = count + Dataanalysis[0].floormeter[i].roommeter[j].usewatermonth

                            htmlsringoverwater += ''
                                + ' <tr>'
                                + '    <td scope="row"> ' + Dataanalysis[0].floormeter[i].roommeter[j].roomNumbermeter + '</td>'
                                + '     <td scope="row"> ' + Dataanalysis[0].floormeter[i].roommeter[j].usewatermonth + '</td>'
                            htmlsringoverwater += '</tr>'
                        }
                    }
                }
                htmlsringoverwater += ''
                    + '  </tbody >'
                htmlsringoverwater += '  </table >'
                    + '<div class="row">'
                    + '       <div class="col-5">'
                    + '          <p class="h5">รวมทั้งสิ้น</p>'
                    + '       </div>'
                    + '     <div class="col-2">'
                    + '         <p>' + count + '</p>'
                    + '      </div>'
                    + '      <div class="col-1">'
                    + '         <p>หน่วย</p>'
                    + '      </div>'
                    + '    </div>'
                document.getElementById("overwater").innerHTML = htmlsringoverwater

            }

            //เเก้ไขห้องพัก----------------------------------------------------
            //อัพเดทห้องพัก
            //  $('#newNodeButton').on('click', function () {
            //   alert('lll')
            //})

            $('#myForm').submit(function () {
                if (CheckFormat()) {
                    alert('Chart is created Success')
                    return true;
                }
                alert('Can not create, Watch your data or images and reCreate!')
                return false
            })
            //เเก้ไขหน้าตั้งค่าชื่อหอพัก
            $('#setName').click(function () {
                if (document.getElementById('phone').value == "") {
                    alert('PLEASE INPUT Phone Number');
                    return false;
                } else if (document.getElementById('email').value == "") {
                    alert('PLEASE INPUT Email');
                    return false;
                }
                var r = confirm("Do you want to change");
                if (r == true) {

                    var Phone = document.getElementById("phone").value
                    var Email = document.getElementById("email").value

                    var dataName = {
                        BuildingName, Phone, Email
                    }
                    console.log('gg')
                    console.log(dataName)

                    var url = "https://electricitymeter.herokuapp.com/postDatabuild";
                    var xhr = new XMLHttpRequest();
                    xhr.open("POST", url, true);
                    xhr.setRequestHeader("Content-Type", "application/json");
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState === 4 && xhr.status === 200) {
                            console.log('res is', xhr.responseText)
                            // if success go login page
                            alert('create user Successful ')
                            renderpage()
                            // window.location.reload(true);
                            //  window.location.href = 'http://127.0.0.1:5500/somelogin.html';

                        } else {
                            //alert('can not create user! Pls try again.')
                        }
                    };
                    var data = JSON.stringify({
                        BuildingName: dataName.BuildingName, Phone: dataName.Phone, Email: dataName.Email
                    });
                    xhr.send(data);


                } else {
                    //   alert('no')
                }
            })
            function renderHome(ourData) {
                console.log('ggrender', ourData)
                var Roomfree = 0
                var Roombusy = 0
                var Roomremodel = 0
                //         console.log(ourData[0].floor[0].room.length)
                for (let i = 0; i < ourData[0].floor.length; i++) {
                    htmlString1 += ''
                        + '  <div class="row justify-content-center">'
                        + '   <div class="col-2 col-sm-2"><br>'
                        + '       <p class="h4">ชั้น</p>'
                        + '   </div>'
                        + '   <div class="col-2 col-sm-2"><br>'
                        + '      <p id="">' + (i + 1) + '</p>'
                        + '   </div>'
                        + '   <div class="col-4 col-sm-3">'
                        + '   <button onclick="Plusroom(this.id);" id="Plusroom' + (i + 1) + '" style="margin-top: 6%" class="btn btn-primary "'
                        + '       type="button">เพิ่มห้อง</button>'
                        + '  </div>'
                        + '  </div>'
                        + '<br><div class="row" >'

                    for (let j = 0; j < ourData[0].floor[i].room.length; j++) {
                        let p = 3
                        if (ourData[0].floor[i].room[j].roomStatus == "ว่าง") {
                            Roomfree = Roomfree + 1
                            htmlString1 += '<div class="bigroom"><div style="text-align:center"> <a>' + ourData[0].floor[i].room[j].roomNumber + '</a> '
                                + ' </div >'
                                //  if()
                                + '     <div style="background-color: green" id="changcss" class="room">  <br>  <p>15230.5kw/h</p></div>'
                                + '    <form action = "https://electricitymeter.herokuapp.com/Person" onsubmit = "SubMit()" method = "POST" >'
                                + '                <button type="submit" class="btn btn-primary">จัดการห้อง</button>'
                                + '       <div class="form-group">'
                                + '           <input style="display:none" value="' + BuildingName + '"  name="BuildingName" type="text" class="form-control" id="exampleInputUsername">'
                                + '           <input style="display:none" value="' + ourData[0].floor[i].room[j].contract + '"  name="room" type="text" class="form-control" id="room">'
                                + '           <input style="display:none" value="' + ourData[0].floor[i].room[j].roomNumber + '"  name="roomNumber" type="number" class="form-control" id="roomNumber">'
                                + '     </div> '
                                + ' </form>'
                                + '     </div> '
                        } else if (ourData[0].floor[i].room[j].roomStatus == "ไม่ว่าง") {
                            Roombusy = Roombusy + 1
                            htmlString1 += '<div class="bigroom"><div style="text-align:center"> <a>' + ourData[0].floor[i].room[j].roomNumber + '</a> '
                                + ' </div >'
                                //  if()
                                + '     <div style="background-color: orange" id="changcss" class="room">  <br>  <p>15230.5kw/h</p></div>'
                                + '    <form action = "https://electricitymeter.herokuapp.com/Person" onsubmit = "SubMit()" method = "POST" >'
                                + '                <button type="submit" class="btn btn-primary">จัดการห้อง</button>'
                                + '       <div class="form-group">'
                                + '           <input style="display:none" value="' + BuildingName + '"  name="BuildingName" type="text" class="form-control" id="exampleInputUsername">'
                                + '           <input style="display:none" value="' + ourData[0].floor[i].room[j].contract + '"  name="room" type="text" class="form-control" id="room">'
                                + '           <input style="display:none" value="' + ourData[0].floor[i].room[j].roomNumber + '"  name="roomNumber" type="number" class="form-control" id="roomNumber">'
                                + '     </div> '
                                + ' </form>'
                                + '     </div> '

                        } else if (ourData[0].floor[i].room[j].roomStatus == "กำลังปรับปรุง") {
                            Roomremodel = Roomremodel + 1
                            htmlString1 += '<div class="bigroom"><div style="text-align:center"> <a>' + ourData[0].floor[i].room[j].roomNumber + '</a> '
                                + ' </div >'
                                //  if()
                                + '     <div style="background-color: gray"  id="changcss" class="room">  <br>  <p>15230.5kw/h</p></div>'
                                + '    <form action = "https://electricitymeter.herokuapp.com/Person" onsubmit = "SubMit()" method = "POST" >'
                                + '                <button type="submit" class="btn btn-primary">จัดการห้อง</button>'
                                + '       <div class="form-group">'
                                + '           <input style="display:none" value="' + BuildingName + '"  name="BuildingName" type="text" class="form-control" id="exampleInputUsername">'
                                + '           <input style="display:none" value="' + ourData[0].floor[i].room[j].contract + '"  name="room" type="text" class="form-control" id="room">'
                                + '           <input style="display:none" value="' + ourData[0].floor[i].room[j].roomNumber + '"  name="roomNumber" type="number" class="form-control" id="roomNumber">'
                                + '     </div> '
                                + ' </form>'
                                + '     </div> '
                        }
                    }
                    htmlString1 += '</div><hr style="border: 1px solid black;">'
                }
                document.getElementById("divPostHome").innerHTML = htmlString1;
                document.getElementById("meter").innerHTML = ourData[0].UnitMeter
                //  document.getElementById("showdatemeterbefor").innerHTML = ourData[0].DateUnitMeter
                //   document.getElementById("showmeterbefor").innerHTML = ourData[0].UnitMeterbefor

                document.getElementById("water").innerHTML = ourData[0].plicewater


                document.getElementById("BuildingName").innerHTML = ourData[0].BuildingName
                document.getElementById("BuildingPhone").innerHTML = ourData[0].BuildingPhone
                document.getElementById("BuildingEmail").innerHTML = ourData[0].BuildingEmail

                document.getElementById("phone").value = ourData[0].BuildingPhone
                document.getElementById("email").value = ourData[0].BuildingEmail

                document.getElementById("free").innerHTML = Roomfree
                document.getElementById("busy").innerHTML = Roombusy
                document.getElementById("remodel").innerHTML = Roomremodel
                var htmlstringunit = ""
                if (ourData[0].DateUnitMeter != undefined) {
                    htmlstringunit +=
                        ' <label for="exampleInputEmail1">อัพเดทล่าสุดเมื่อวันที่</label>'
                        + '                             <p id="showdatemeterbefor">' + ourData[0].DateUnitMeter + '</p>'
                        + '                            <label for="exampleInputEmail1">หน่วยมิเตอร์ก่อนหน้า</label>'
                        + '                              <div class="row">'
                        + '                                 <div class="col-1" id="showmeterbefor">' + ourData[0].UnitMeterbefor + '</div>'
                        + '                                    <div class="col-3">บาท'
                        + '                                  </div>'
                        + '                              </div>'
                    document.getElementById("setshowunit").innerHTML = htmlstringunit

                }
                if (ourData[0].DateUnitWater != undefined) {
                    var htmlstringunitwater = ""

                    htmlstringunitwater +=
                        ' <label for="exampleInputEmail1">อัพเดทล่าสุดเมื่อวันที่</label>'
                        + '                             <p id="">' + ourData[0].DateUnitWater + '</p>'
                        + '                            <label for="exampleInputEmail1">หน่วยมิเตอร์ก่อนหน้า</label>'
                        + '                              <div class="row">'
                        + '                                 <div class="col-1" >' + ourData[0].plicewaterbefor + '</div>'
                        + '                                    <div class="col-3">บาท'
                        + '                                  </div>'
                        + '                              </div>'
                    document.getElementById("setshowunitwater").innerHTML = htmlstringunitwater
                }
            }
            //render หน้าเเก้ไขห้องพัก อัพเดทห้องพัก       
            function renderedithome(ourData) {
                let l = 1
                for (let i = 0; i < ourData[0].floor.length; i++) {

                    htmlStringedithome +=
                        ' <div  class="row justify-content-md-center">'
                        + ' <div class="divform">'
                        + '  <div class="row justify-content-center">'
                        + '   <div class="col-2 col-sm-2"><br>'
                        + '       <p class="h4">ชั้น</p>'
                        + '   </div>'
                        + '   <div class="col-2 col-sm-2"><br>'
                        + '      <p id="">' + (i + 1) + '</p>'
                        + '   </div>'
                        + '   <div class="col-4 col-sm-3">'
                        + '   <button onclick="Plusroom(this.id);" id="Plusroom' + (i + 1) + '" style="margin-top: 6%" class="btn btn-primary "'
                        + '       type="button">เพิ่มห้อง</button>'
                        + '  </div>'
                        + '  </div>'
                        + '   <table class="table table-bordered" >'
                        + '  <thead>'
                        + '     <tr>'
                        + '     <th scope="col" style="background-color: grey ; height: 50px;">หมายเลขห้อง</th>'
                        + '       <th scope="col" style="background-color: grey">สถานะห้อง</th>'
                        + '      <th scope="col" style="background-color: grey">ลบข้อมูล</th>'
                        + '     </tr>'
                        + '  </thead>'



                    for (let j = 0; j < ourData[0].floor[i].room.length; j++) {

                        htmlStringedithome += '<tbody > <tr><th scope="row">' + ourData[0].floor[i].room[j].roomNumber + '</th><td>' + ourData[0].floor[i].room[j].roomStatus + '</th><td><div id="img_container"><img class="remove ' + (ourData[0].floor[i].room[j].roomNumber) + '" width="20px" height="20px" src="https://cdn0.iconfinder.com/data/icons/round-ui-icons/512/close_red.png"></div></td></tbody> '
                    }
                    htmlStringedithome += '</table></div></div><br>'
                }
                htmlStringedithome += '<a class="bg-success d-block text-center rounded mt-4" id="newNodeButton" data-toggle="tooltip"'
                'data-placement="top" title="Add new node"><i class="fas fa-plus p-2" style="color:white; font-size: 14px;"></i></a>'

                tablePostedit.insertAdjacentHTML('beforeend', htmlStringedithome);

            }
            function makeClick(ourData) {
                $('.remove').click(function (e) {
                    //  alert('remove ' + e.target.classList[1])
                    var r = confirm("Do you want to delete the person?");
                    if (r == true) {

                        let count = e.target.classList[1]
                        console.log(count)
                        for (let i = 0; i < ourData[0].floor.length; i++) {
                            for (let j = 0; j < ourData[0].floor[i].room.length; j++) {
                                if (count == ourData[0].floor[i].room[j].roomNumber) {
                                    ourData[0].floor[i].room[j].pop()
                                    console.log(ourData[0].floor[i].room[j])
                                }
                            }
                        }
                        var newUser = {
                            personID, firstName, lastName, birthday, address, phoneNumber, License, BuildingName, roomNumber
                        }
                    } else {
                        //   alert('no')
                    }
                })
            }
            //เเจ้งปรับปรุงห้องพัก
            function renderUpdate(ourData) {
                let l = 1
                for (let i = 0; i < ourData[0].floor.length; i++) {

                    htmlStringUpdate +=
                        ' <div  class="row justify-content-md-center">'
                        + ' <div class="divform">'
                        + '  <div class="row justify-content-center">'
                        + '   <div class="col-2 col-sm-2"><br>'
                        + '       <p class="h4">ชั้น</p>'
                        + '   </div>'
                        + '   <div class="col-2 col-sm-2"><br>'
                        + '      <p id="Updatefloor">' + (i + 1) + '</p>'
                        + '   </div>'
                        + '  </div>'
                        + '   <table class="table table-bordered" >'
                        + '  <thead>'
                        + '     <tr>'
                        + '     <th scope="col" style="background-color: grey ; height: 50px;"><input type="checkbox" value="' + (i + 1) + '" class="select_all ' + (i + 1) + '" id="select_all" /></th>'
                        + '       <th scope="col" style="background-color: grey">หมายเลขห้อง</th>'
                        + '     </tr>'
                        + '  </thead>'

                    for (let j = 0; j < ourData[0].floor[i].room.length; j++) {

                        htmlStringUpdate += '<tbody > <tr><th scope="row"><input type="checkbox" name="UpdateRoom" class="checkbox"value="' + ourData[0].floor[i].room[j].roomNumber + '" /></th><td>' + ourData[0].floor[i].room[j].roomNumber + '</th></tbody> '
                    }
                    htmlStringUpdate += '</table></div></div><br>'
                }
                tablePostUpdate.insertAdjacentHTML('beforeend', htmlStringUpdate);

                $('.select_all').click(function (e) {
                    let upfloor = e.target.classList[1]
                    console.log(upfloor)
                    if (this.checked) {
                        $('.checkbox').each(function () {
                            console.log('gdp', this.value)
                            for (let i = 0; i < ourData[0].floor.length; i++) {
                                for (let j = 0; j < ourData[0].floor[i].room.length; j++) {
                                    if (upfloor == (i + 1)) {
                                        if (this.value == ourData[0].floor[i].room[j].roomNumber) {
                                            this.checked = true;
                                            console.log("ppppp", this.value)
                                        }
                                    }
                                }
                            }

                        });
                    } else {
                        $('.checkbox').each(function () {
                            this.checked = false;
                        });
                    }
                });
                $('#formUpdate').click(function () {
                    let RoomUpdate = []
                    $.each($("input[name='UpdateRoom']:checked"), function () {
                        RoomUpdate.push($(this).val());
                    });
                    //  alert("My favourite value are: " + RoomUpdate.join(", "));
                    var DataRoomUpdate = {
                        BuildingName, RoomUpdate
                    }
                    console.log(DataRoomUpdate)

                    var url = "https://electricitymeter.herokuapp.com/postRoomUpdate";
                    var xhr = new XMLHttpRequest();
                    xhr.open("POST", url, true);
                    xhr.setRequestHeader("Content-Type", "application/json");
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState === 4 && xhr.status === 200) {
                            console.log('res is', xhr.responseText)
                            // if success go login page
                            alert('create user Successful ')

                            window.location.reload(true);
                            //  window.location.href = 'http://127.0.0.1:5500/somelogin.html';

                        } else {
                            //alert('can not create user! Pls try again.')
                        }
                    };
                    var data = JSON.stringify({
                        BuildingName: DataRoomUpdate.BuildingName, RoomUpdate: DataRoomUpdate.RoomUpdate,
                    });
                    xhr.send(data);
                    return false
                });
            }
            // กรอกข้อมูลของ user
            function FunctionUser(user) {

                alert('success')
            }
            /* function css() {
                 $("changcss").classList.add('roomgrey')
                 document.body.classList.add('article');
                 alert('success')
             } */
            //--------------------------------------------------------------------------------------------------
            //หน้า 2 ผู้เช่าเก่า ผู้เช่าใหม่
            function renderUser(ourData) {
                let l = 1
                for (let i = 0; i < ourData[0].floor.length; i++) {
                    for (let j = 0; j < ourData[0].floor[i].room.length; j++) {

                        for (let k = 0; k < ourData[0].floor[i].room[j].user.length; k++) {
                            htmlString += '<tr><th scope="row">' + (l++) + '</th><td>' + ourData[0].BuildingName + '</th><td>' + ourData[0].floor[i].room[j].roomNumber + '</th><td>' + ourData[0].floor[i].room[j].user[k].personID + '</td><td>'
                                + ourData[0].floor[i].room[j].user[k].firstName + '</td><td>' + ourData[0].floor[i].room[j].user[k].lastName + '</td><td>' + ourData[0].floor[i].room[j].user[k].birthday + '</td><td>' + ourData[0].floor[i].room[j].user[k].address + '</td><td>' + ourData[0].floor[i].room[j].user[k].phoneNumber + '</td><td>' + ourData[0].floor[i].room[j].user[k].License + '</td><td>'

                        }
                    }
                }
                tablePost.insertAdjacentHTML('beforeend', htmlString);
            }
            function Userdelete() {
                var ourRequest = new XMLHttpRequest();
                ourRequest.open('GET', 'https://electricitymeter.herokuapp.com/getUserdelete')
                ourRequest.onload = function () {
                    var ourData = JSON.parse(ourRequest.responseText);
                    //      console.log(ourData)
                    //     console.log('sdsdsdsdsds')
                    let l = 1
                    for (let i = 0; i < ourData.length; i++) {
                        htmlStringUserdelete += '<tr><th scope="row">' + (l++) + '</th><td>' + ourData[i].BuildingNameAllow + '</th><td>' + ourData[i].roomNumberAllow + '</th><td>' + ourData[i].personIDAllow + '</td><td>'
                            + ourData[i].firstNameAllow + '</td><td>' + ourData[i].lastNameAllow + '</td><td>' + ourData[i].birthdayAllow + '</td><td>' + ourData[i].ad + '</td><td>' + ourData[i].phoneNumberAllow + '</td><td>' + ourData[i].Li + '</td><td>'
                    }
                    tablePostUserdelete.insertAdjacentHTML('beforeend', htmlStringUserdelete);

                }
                ourRequest.send();
            }
        });
    </script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
</body>

</html>