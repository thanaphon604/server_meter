<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">
  <title>ระบบบันทึกหน่วยไฟฟ้าอัจฉริยะ</title>
  <link rel="stylesheet" href="">
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

  <style>
    body{
            background-color:rgb(236, 236, 236)
        }
        #Head {
    font-size: 20px;
    background-color: #FFA500;
    color: black;
    border: 2px
  }
  div.bigroom{
    width: 100px;
    height: 150px;
    margin-left: 5%
  }
  .divform{
    width: 100%;
    padding: 12px 20px;
    margin: 8px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
    background-color:whitesmoke;

  }
  div.room{
    border: 2px solid black;
    width: 100px;
    height: 90px;
  }
  .TextHead{
    font-size: 50px
    
  }
 
 
     #box { 
    border: 3px solid rgb(10, 10, 10);
    display: block;
    margin: auto;
    border-radius: 5%;
    padding: 10px;
    background-color: rgb(190, 225, 248)
}
body {font-family: Arial, Helvetica, sans-serif;}
* {box-sizing: border-box;}

/* Button used to open the contact form - fixed at the bottom of the page */
.open-button {
  background-color: #555;
  color: white;
  padding: 16px 20px;
  border: none;
  
  opacity: 0.8;
  
  bottom: 23px;
  right: 28px;
  width: 280px;
}

/* The popup form - hidden by default */
.form-popup {
  display: none;
  width: 1000px;
  border: 3px solid #f1f1f1;
  margin-left: auto;
 margin-right: auto;
    
}

/* Add styles to the form container */
.form-container {
  width: 100%;
  padding: 10px;
  background-color: white;
}

/* Full-width input fields */
.form-container {
  width: 100%;
  padding: 15px;
  margin: 5px 0 22px 0;
  border: none;
  background: rgb(249, 253, 253);
}

/* When the inputs get focus, do something */
.form-container input[type=text]:focus, .form-container input[type=password]:focus {
  background-color: #ddd;
  
}

/* Set a style for the submit/login button */
.form-container .btn {
  background-color: #4CAF50;
  color: white;
  padding: 16px 20px;
  border: none;
  cursor: pointer;
  width: 100%;
  margin-bottom:10px;
  opacity: 0.8;
}

/* Add a red background color to the cancel button */
.form-container .cancel {
  background-color: red;
}

/* Add some hover effects to buttons */
.form-container .btn:hover, .open-button:hover {
  opacity: 1;
}
</style>




</head>

<body onunload="unloadFN()">
  <div class="container-fluid" id="Head">
    <div class="class col-sm-12 ">
      <div class="row justify-content-center">
        <ul>
          <img src="https://www.bpicc.com/images/2018/10/09/Logo_Intregrate.png" width="90px" height="90px" alt="">
        </ul>
        <ul>
          <img src="https://www.bpicc.com/images/2018/10/09/lg_wu.png" width="80px" height="90px" alt="">

        </ul>
        <div>
          <ul>
            <h1>ระบบบันทึกหน่วยไฟฟ้าอัจฉริยะ </h1>
          </ul>
          <ul>
            <h5>(Smart energy monitoring system)</h2>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <nav class="navbar navbar-expand-lg navbar-light bg-light navbar navbar-dark bg-dark">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo02"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
      <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
      </ul>


    </div>
    <form class="form-inline my-2 my-lg-0 fixed-right">

    </form>
  </nav>
  <nav>
    <div class="nav nav-tabs" id="nav-tab" role="tablist">
      <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home"
        aria-selected="true">Login</a>
      <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile"
        aria-selected="false">Register</a>

    </div>
  </nav>
  <div class="tab-content" id="nav-tabContent">

    <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
      <div class="container" style="margin-top: 30px">
        <div class="row justify-content-center">
          <div class="col-12 col-md-8  ">
            <div align="center">
              <img src="https://www.bpicc.com/images/2018/10/09/Logo_Intregrate.png" width="40%" height="40%" alt="">
            </div>
            <p class="subject">ระบบบันทึกหน่วยไฟฟ้าอัจฉริยะ</p>

            <h3>สำหรับผู้ดูเเลหอพัก</h3>
            <!-- {{!-- https://electricitymeter.herokuapp.com/
            action="http://localhost:3000/signin"
            --}} -->

            <div class="divform">
              <form>
              {{!-- <form action="https://electricitymeter.herokuapp.com/signin" onsubmit="SubMit()" method="POST"> --}}
                <div class="form-group">
                  <label for="exampleInputEmail1">Username</label>
                  <input required name="username" type="text" class="form-control" id="userLogin"
                    placeholder="Enter Username">
                </div>
                <div class="form-group">
                  <label for="exampleInputPassword1">Password</label>
                  <input required name="password" type="password" class="form-control" id="passwordLogin"
                    placeholder="Password">
                </div>
                <hr>
                {{!-- <button type="submit" class="btn btn-primary">Submit</button> --}}
                <button type="button" onclick="SubMit()" class="btn btn-primary">Submit</button>
              </form>
            </div>
          </div>

        </div>
      </div>


    </div>

    <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
      <div class="container" style="margin-top: 30px">
        <div class="row justify-content-center">
          <div class="col-12 col-md-8  ">
            <div align="center">
              <img src="https://www.bpicc.com/images/2018/10/09/Logo_Intregrate.png" width="40%" height="40%" alt="">
              <h3>กรุณากรอกข้อมูลให้ครบถ้วนเพื่อทำการสร้าง Username เเละ Password</h3>
            </div>
            <hr>
            <div class="divform">
              <form name="form1" id="form1" class="form-horizontal" action='' onsubmit="return false">
                <label for="exampleInputEmail1" style="color: red">
                  <h5>*กรุณากรอกข้อมูลให้ครบทุกช่องในการสมัครสมาชิก</h5>
                </label>

                <div class="form-group">

                  <label class="" for="username">Username</label>
                  <div class="controls">
                    <input type="text" class="form-control" id="username" name="username" placeholder="">
                    <!--   <p class="help-block">Username can contain any letters or numbers, without spaces</p>-->
                  </div>
                </div>

                <div class="control-group">
                  <!-- Password-->
                  <label class="control-label" for="password">Password</label>
                  <div class="controls">
                    <input type="password" class="form-control" id="password" name="password" placeholder="">
                    <!--   <p class="help-block">Password should be at least 4 characters</p>-->
                  </div>
                  <div id="validationText"></div>
                </div>

                <div class="control-group">
                  <!-- Password -->
                  <label class="control-label" for="password_confirm">Password (Confirm)</label>
                  <div class="controls">
                    <input type="password" class="form-control" id="password_confirm" name="password_confirm"
                      placeholder="" class="input-xlarge">
                    <!--    <p class="help-block">Please confirm password</p>-->
                  </div>
                  <div id="validationTextpass"></div>

                </div>

                <div class="control-group">
                  <label class="control-label" for="fname">First Name</label>
                  <div class="controls">
                    <input type="text" class="form-control" id="fname" name="fname" placeholder="">
                  </div>
                </div>

                <div class="control-group">
                  <label class="control-label" for="lname">Last Name</label>
                  <div class="controls">
                    <input type="text" class="form-control" id="lname" name="lname" placeholder="">
                  </div>
                </div>

                <div class="control-group">
                  <label class="control-label" for="phone">Phone number</label>
                  <div class="controls">
                    <input oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
                      type="number" maxlength="10" class="form-control" id="phone" name="phone" placeholder="">
                  </div>
                  <div id="validationTextphone"></div>
                </div>
                <br>
                <div class="control-group">
                  <!-- Button -->
                  <div class="controls">
                    <button id="reg" class="btn btn-success" type="button">Register</button>
                  </div>
                </div>

              </form>
            </div>
          </div>
        </div>
      </div>


    </div>

  </div>


  <!--
  Extra small <576px   col
  small > 576      px  col-sm
  mediu, >= 768        col-md
  Large >=992 px       com-lg
  Extra Large >= 120px col-xl
-->




  <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
    crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>

  <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
    crossorigin="anonymous"></script>
  <script>

    function SubMit(){
      console.log('clicked')
      let user = document.getElementById('userLogin')
      let password = document.getElementById('passwordLogin')
      var xhr = new XMLHttpRequest();
      let url = 'https://electricitymeter.herokuapp.com/signin'
      xhr.open("POST", url, true);
      xhr.setRequestHeader("Content-Type", "application/json");
      xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {

          console.log("user is : ", user)
          console.log('password is : ', password)
          console.log('res is', xhr.responseText)
          //alert('create user Successful ')
          // window.location.href = 'https://electricitymeter.herokuapp.com/Loginadmin'
        } else {
          console.log('error : ', xhr.responseText)
          //alert('can not create user! Pls try again.')
        }
      };
      
      xhr.send(JSON.stringify({ username: user, password }))
    }

    function unloadFN() {

    }
    $(document).ready(function () {


      // เมื่อเกิดเหตุการ submit form
      $('#reg').click(function () {
        // alert('submit   ')
        if (document.getElementById('username').value == "") {
          alert('Please Input Username');
          return false;
        } else if (document.getElementById('password').value == "") {
          alert('Please Input Password ');
          return false;
        } else if (document.getElementById('password_confirm').value == "") {
          alert('Please Input Confirm Password');
          return false;
        } else if (document.getElementById('password').value != document.getElementById('password_confirm').value) {
          alert('The password does not match');
          return false;
        }
        var username = document.getElementById('username').value
        var password = document.getElementById('password').value
        var fname = document.getElementById('fname').value
        var lname = document.getElementById('lname').value
        var phone = document.getElementById('phone').value


        //var newAdmin = '{"username" :"' + username + '""password":"' + password + '"}'
        var newAdmin = {
          username, password, fname, lname, phone
        }
        console.log(newAdmin)
        postData(newAdmin)
        // console.log('newAdmin:', newAdmin)
        // console.log('json: ', JSON.stringify({ newAdmin }))



      });
      $('#password').on('input', function (e) {
        var obj = document.getElementById('password').value


        if (document.getElementById('password').value == "" || obj.length <= 5) {
          document.getElementById("validationText").style.color = "red";
          document.getElementById("validationText").innerHTML = 'กรุณากรอกอย่างน้อย 6 ตัวอักษร';
        } else {
          document.getElementById("validationText").style.color = "green";
          document.getElementById("validationText").innerHTML = "password สามารถใช้งานได้";
        }
      })
      $('#password_confirm').on('input', function (e) {
        var obj = document.getElementById('password_confirm').value


        if (document.getElementById('password').value == "" || obj != document.getElementById('password').value) {
          document.getElementById("validationTextpass").style.color = "red";
          document.getElementById("validationTextpass").innerHTML = 'password ไม่ตรงกัน ';
        } else {
          document.getElementById("validationTextpass").style.color = "green";
          document.getElementById("validationTextpass").innerHTML = "password ตรงกัน";
        }
      })
      $('#phone').on('input', function (e) {
        var objp = document.getElementById('phone').value
        console.log(objp)

        if (document.getElementById('phone').value == "" || objp.length < 9) {
          document.getElementById("validationTextphone").style.color = "red";
          document.getElementById("validationTextphone").innerHTML = 'กรุณากรอกข้อมูลเฉพาะตัวเลข ';
        } else {
          document.getElementById("validationTextphone").innerHTML = "";
        }
      })
      function postData(newAdmin) {
        var url = "https://electricitymeter.herokuapp.com/postAdmin";
        console.log('===============')
        console.log(newAdmin.username)
        console.log(newAdmin.password)
        console.log(newAdmin.fname)
        console.log(newAdmin.lname)
        console.log(newAdmin.phone)
        console.log('===============')
        // let res = $.post(url, { username: newAdmin.username, password: newAdmin.password }) 
        // let res = $.post(url, { username: newAdmin.username, password: newAdmin.password },  function(data, status){
        //     console.log('data:'+ data)
        //     console.log('status'+ status)
        // })

        var xhr = new XMLHttpRequest();
        xhr.open("POST", url, true);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            console.log('res is', xhr.responseText)
            // if success go login page
            alert('create user Successful ')
            window.location.href = 'https://electricitymeter.herokuapp.com/Loginadmin';

          } else {
            //alert('can not create user! Pls try again.')
          }
        };
        var data = JSON.stringify({
          username: newAdmin.username, password: newAdmin.password, fname: newAdmin.fname,
          lname: newAdmin.lname, phone: newAdmin.phone
        });
        xhr.send(data);
      }

    })

  </script>

</body>

</html>